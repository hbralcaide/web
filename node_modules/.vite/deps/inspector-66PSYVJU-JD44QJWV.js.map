{
  "version": 3,
  "sources": ["../../@mappedin/mappedin-js/src/api-geojson/inspector/index.ts", "../../@mappedin/mappedin-js/src/api-geojson/inspector/inspector.ts", "../../@mappedin/mappedin-js/src/api-geojson/inspector/mapview-control.ts", "../../node_modules/.pnpm/lil-gui@0.19.2/node_modules/lil-gui/dist/lil-gui.esm.js", "../../@mappedin/mappedin-js/src/api-geojson/inspector/labels-control.ts", "../../@mappedin/mappedin-js/src/api-geojson/inspector/utils.ts", "../../@mappedin/mappedin-js/src/api-geojson/inspector/interaction-control.ts", "../../@mappedin/mappedin-js/src/api-geojson/inspector/highlight.ts", "../../@mappedin/mappedin-js/src/api-geojson/inspector/search-control.ts", "../../@mappedin/mappedin-js/src/api-geojson/inspector/style.scss", "../../@mappedin/mappedin-js/src/api-geojson/inspector/camera-controls.ts", "../../@mappedin/mappedin-js/src/api-geojson/inspector/markers-control.ts", "../../@mappedin/mappedin-js/src/api-geojson/inspector/walls-control.ts", "../../@mappedin/mappedin-js/src/api-geojson/inspector/misc-control.ts", "../../@mappedin/mappedin-js/src/api-geojson/inspector/debug-control.ts", "../../@mappedin/mappedin-js/src/api-geojson/inspector/text3d-control.ts"],
  "sourcesContent": ["export { Inspector } from './inspector';\n", "import { mountSceneGraphVisualizer } from '@mappedin/core-sdk';\nimport type MapData from '../../map-data';\nimport type { MapView } from '../../map-view';\nimport type { GeoJsonApi } from '../api';\nimport { createUi } from './mapview-control';\n\nexport class Inspector {\n\tprivate _enabled = false;\n\tprivate mv: MapView;\n\tprivate api: GeoJsonApi;\n\tprivate mapData?: MapData;\n\tprivate scenegraphVisualizerMounted = false;\n\tstoreStateToLocalStorageEnabled = false;\n\n\tconstructor(mv: MapView, api: GeoJsonApi) {\n\t\tthis.mv = mv;\n\t\tthis.api = api;\n\t\tthis.mapData = this.api.getMapData();\n\t}\n\tsetMapData(data: MapData) {\n\t\tthis.mapData = data;\n\t}\n\tasync enable(options: InspectorOption = {}) {\n\t\tif (this._enabled) return;\n\t\tthis._enabled = true;\n\t\tif (!this.mapData) {\n\t\t\tthrow new Error('Please set mapData before enable debug.');\n\t\t}\n\t\tconst { sceneFolder } = createUi(this.mapData, this.mv, options);\n\t\tsceneFolder.onOpenClose(v => {\n\t\t\tif (v === sceneFolder && !v._closed && !this.scenegraphVisualizerMounted) {\n\t\t\t\tthis.scenegraphVisualizerMounted = true;\n\t\t\t\t// this is very expensive. gets \"lazy\" mounted\n\t\t\t\tmountSceneGraphVisualizer(this.api.core, sceneFolder);\n\t\t\t}\n\t\t});\n\n\t\tthis.api.getMapDataInternal()?.spaces.forEach(f => {\n\t\t\tthis.mv.updateState(f, { interactive: true });\n\t\t});\n\t}\n\tget enabled() {\n\t\treturn this._enabled;\n\t}\n}\n\nexport type InspectorState = { camera: { focusOnClick: boolean; padding: [number, number, number, number] } };\nexport type InspectorOption = Partial<InspectorState>;\n", "import type { MapView } from '../../map-view';\nimport GUI from 'lil-gui';\nimport { createLabelControls } from './labels-control';\nimport { createInteractionControls } from './interaction-control';\nimport css from './style.scss';\nimport { createCameraControls } from './camera-controls';\nimport type MapData from '../../map-data';\nimport { createMarkerControls } from './markers-control';\nimport { createGeometryControl } from './walls-control';\nimport { createMiscControl } from './misc-control';\nimport type { InspectorOption } from './inspector';\nimport { createDebugControl } from './debug-control';\nimport { createText3DControl } from './text3d-control';\n\nexport function createUi<T extends MapView>(mapData: MapData, mapView: T, options?: InspectorOption) {\n\tinjectCss();\n\tconst panel = new GUI({ title: 'SDK Controls' });\n\tpanel.domElement.classList.add('mappedin-js-inspector');\n\tcreateInteractionControls(mapView, mapData, panel);\n\tcreateCameraControls(panel, mapView, options?.camera);\n\tconst levelsFolder = panel.addFolder('Levels').close();\n\tconst sceneFolder = panel.addFolder('Scene Controls');\n\tsceneFolder.close();\n\tconst labelFolder = panel.addFolder('Labels');\n\tcreateText3DControl(panel, mapView, mapData);\n\tconst markerFolder = panel.addFolder('Markers');\n\tcreateGeometryControl(panel, mapView);\n\tconst miscFolder = panel.addFolder('misc');\n\tcreateDebugControl(panel, mapView, mapData);\n\tcreateMiscControl(miscFolder, mapView, mapData);\n\n\tconst state = {\n\t\tlevel: mapView.currentFloor.id,\n\t};\n\n\tconst { populatelabels } = createLabelControls(labelFolder, mapData, mapView);\n\tconst { populateMarkers } = createMarkerControls(markerFolder, mapData, mapView);\n\n\tconst levels = mapData.getByType('floor').reduce((acc, floor) => {\n\t\tacc[floor.name] = floor.id;\n\n\t\treturn acc;\n\t}, {});\n\tconst levelsControl = levelsFolder.add(state, 'level', levels).onChange(update => {\n\t\tmapView.setFloor(update);\n\t\tstate.level = mapView.currentFloor.id;\n\t\tlevelsControl.updateDisplay();\n\t});\n\n\tmapView.on('floor-change-start', event => {\n\t\tlevelsFolder.controllers[0].setValue(event.floor.id);\n\t});\n\n\tmapData.getByType('space').forEach(s => {\n\t\tmapView.updateState(s, { interactive: true });\n\t});\n\tmapData.getByType('object').forEach(s => {\n\t\tmapView.updateState(s, { interactive: true });\n\t});\n\n\tmapData.getByType('object').forEach(o => {\n\t\tmapView.updateState(o, { interactive: true });\n\t});\n\tmapView.setHoverColor('#a2b7e6');\n\tmapView.Camera.setMaxZoomLevel(20);\n\n\treturn { populatelabels, sceneFolder, populateMarkers };\n}\n\nconst STYLE_EL_ID = 'mappedin-sdk-debug-css';\nfunction injectCss() {\n\tif (document.getElementById(STYLE_EL_ID)) {\n\t\treturn;\n\t}\n\tconst style = document.createElement('style');\n\tstyle.id = STYLE_EL_ID;\n\tstyle.textContent = css;\n\tdocument.head.appendChild(style);\n}\n", "/**\n * lil-gui\n * https://lil-gui.georgealways.com\n * @version 0.19.2\n * @author George Michael Brower\n * @license MIT\n */\n\n/**\n * Base class for all controllers.\n */\nclass Controller {\n\n\tconstructor( parent, object, property, className, elementType = 'div' ) {\n\n\t\t/**\n\t\t * The GUI that contains this controller.\n\t\t * @type {GUI}\n\t\t */\n\t\tthis.parent = parent;\n\n\t\t/**\n\t\t * The object this controller will modify.\n\t\t * @type {object}\n\t\t */\n\t\tthis.object = object;\n\n\t\t/**\n\t\t * The name of the property to control.\n\t\t * @type {string}\n\t\t */\n\t\tthis.property = property;\n\n\t\t/**\n\t\t * Used to determine if the controller is disabled.\n\t\t * Use `controller.disable( true|false )` to modify this value.\n\t\t * @type {boolean}\n\t\t */\n\t\tthis._disabled = false;\n\n\t\t/**\n\t\t * Used to determine if the Controller is hidden.\n\t\t * Use `controller.show()` or `controller.hide()` to change this.\n\t\t * @type {boolean}\n\t\t */\n\t\tthis._hidden = false;\n\n\t\t/**\n\t\t * The value of `object[ property ]` when the controller was created.\n\t\t * @type {any}\n\t\t */\n\t\tthis.initialValue = this.getValue();\n\n\t\t/**\n\t\t * The outermost container DOM element for this controller.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.domElement = document.createElement( elementType );\n\t\tthis.domElement.classList.add( 'controller' );\n\t\tthis.domElement.classList.add( className );\n\n\t\t/**\n\t\t * The DOM element that contains the controller's name.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$name = document.createElement( 'div' );\n\t\tthis.$name.classList.add( 'name' );\n\n\t\tController.nextNameID = Controller.nextNameID || 0;\n\t\tthis.$name.id = `lil-gui-name-${++Controller.nextNameID}`;\n\n\t\t/**\n\t\t * The DOM element that contains the controller's \"widget\" (which differs by controller type).\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$widget = document.createElement( 'div' );\n\t\tthis.$widget.classList.add( 'widget' );\n\n\t\t/**\n\t\t * The DOM element that receives the disabled attribute when using disable().\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$disable = this.$widget;\n\n\t\tthis.domElement.appendChild( this.$name );\n\t\tthis.domElement.appendChild( this.$widget );\n\n\t\t// Don't fire global key events while typing in a controller\n\t\tthis.domElement.addEventListener( 'keydown', e => e.stopPropagation() );\n\t\tthis.domElement.addEventListener( 'keyup', e => e.stopPropagation() );\n\n\t\tthis.parent.children.push( this );\n\t\tthis.parent.controllers.push( this );\n\n\t\tthis.parent.$children.appendChild( this.domElement );\n\n\t\tthis._listenCallback = this._listenCallback.bind( this );\n\n\t\tthis.name( property );\n\n\t}\n\n\t/**\n\t * Sets the name of the controller and its label in the GUI.\n\t * @param {string} name\n\t * @returns {this}\n\t */\n\tname( name ) {\n\t\t/**\n\t\t * The controller's name. Use `controller.name( 'Name' )` to modify this value.\n\t\t * @type {string}\n\t\t */\n\t\tthis._name = name;\n\t\tthis.$name.textContent = name;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Pass a function to be called whenever the value is modified by this controller.\n\t * The function receives the new value as its first parameter. The value of `this` will be the\n\t * controller.\n\t *\n\t * For function controllers, the `onChange` callback will be fired on click, after the function\n\t * executes.\n\t * @param {Function} callback\n\t * @returns {this}\n\t * @example\n\t * const controller = gui.add( object, 'property' );\n\t *\n\t * controller.onChange( function( v ) {\n\t * \tconsole.log( 'The value is now ' + v );\n\t * \tconsole.assert( this === controller );\n\t * } );\n\t */\n\tonChange( callback ) {\n\t\t/**\n\t\t * Used to access the function bound to `onChange` events. Don't modify this value directly.\n\t\t * Use the `controller.onChange( callback )` method instead.\n\t\t * @type {Function}\n\t\t */\n\t\tthis._onChange = callback;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Calls the onChange methods of this controller and its parent GUI.\n\t * @protected\n\t */\n\t_callOnChange() {\n\n\t\tthis.parent._callOnChange( this );\n\n\t\tif ( this._onChange !== undefined ) {\n\t\t\tthis._onChange.call( this, this.getValue() );\n\t\t}\n\n\t\tthis._changed = true;\n\n\t}\n\n\t/**\n\t * Pass a function to be called after this controller has been modified and loses focus.\n\t * @param {Function} callback\n\t * @returns {this}\n\t * @example\n\t * const controller = gui.add( object, 'property' );\n\t *\n\t * controller.onFinishChange( function( v ) {\n\t * \tconsole.log( 'Changes complete: ' + v );\n\t * \tconsole.assert( this === controller );\n\t * } );\n\t */\n\tonFinishChange( callback ) {\n\t\t/**\n\t\t * Used to access the function bound to `onFinishChange` events. Don't modify this value\n\t\t * directly. Use the `controller.onFinishChange( callback )` method instead.\n\t\t * @type {Function}\n\t\t */\n\t\tthis._onFinishChange = callback;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Should be called by Controller when its widgets lose focus.\n\t * @protected\n\t */\n\t_callOnFinishChange() {\n\n\t\tif ( this._changed ) {\n\n\t\t\tthis.parent._callOnFinishChange( this );\n\n\t\t\tif ( this._onFinishChange !== undefined ) {\n\t\t\t\tthis._onFinishChange.call( this, this.getValue() );\n\t\t\t}\n\n\t\t}\n\n\t\tthis._changed = false;\n\n\t}\n\n\t/**\n\t * Sets the controller back to its initial value.\n\t * @returns {this}\n\t */\n\treset() {\n\t\tthis.setValue( this.initialValue );\n\t\tthis._callOnFinishChange();\n\t\treturn this;\n\t}\n\n\t/**\n\t * Enables this controller.\n\t * @param {boolean} enabled\n\t * @returns {this}\n\t * @example\n\t * controller.enable();\n\t * controller.enable( false ); // disable\n\t * controller.enable( controller._disabled ); // toggle\n\t */\n\tenable( enabled = true ) {\n\t\treturn this.disable( !enabled );\n\t}\n\n\t/**\n\t * Disables this controller.\n\t * @param {boolean} disabled\n\t * @returns {this}\n\t * @example\n\t * controller.disable();\n\t * controller.disable( false ); // enable\n\t * controller.disable( !controller._disabled ); // toggle\n\t */\n\tdisable( disabled = true ) {\n\n\t\tif ( disabled === this._disabled ) return this;\n\n\t\tthis._disabled = disabled;\n\n\t\tthis.domElement.classList.toggle( 'disabled', disabled );\n\t\tthis.$disable.toggleAttribute( 'disabled', disabled );\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Shows the Controller after it's been hidden.\n\t * @param {boolean} show\n\t * @returns {this}\n\t * @example\n\t * controller.show();\n\t * controller.show( false ); // hide\n\t * controller.show( controller._hidden ); // toggle\n\t */\n\tshow( show = true ) {\n\n\t\tthis._hidden = !show;\n\n\t\tthis.domElement.style.display = this._hidden ? 'none' : '';\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Hides the Controller.\n\t * @returns {this}\n\t */\n\thide() {\n\t\treturn this.show( false );\n\t}\n\n\t/**\n\t * Changes this controller into a dropdown of options.\n\t *\n\t * Calling this method on an option controller will simply update the options. However, if this\n\t * controller was not already an option controller, old references to this controller are\n\t * destroyed, and a new controller is added to the end of the GUI.\n\t * @example\n\t * // safe usage\n\t *\n\t * gui.add( obj, 'prop1' ).options( [ 'a', 'b', 'c' ] );\n\t * gui.add( obj, 'prop2' ).options( { Big: 10, Small: 1 } );\n\t * gui.add( obj, 'prop3' );\n\t *\n\t * // danger\n\t *\n\t * const ctrl1 = gui.add( obj, 'prop1' );\n\t * gui.add( obj, 'prop2' );\n\t *\n\t * // calling options out of order adds a new controller to the end...\n\t * const ctrl2 = ctrl1.options( [ 'a', 'b', 'c' ] );\n\t *\n\t * // ...and ctrl1 now references a controller that doesn't exist\n\t * assert( ctrl2 !== ctrl1 )\n\t * @param {object|Array} options\n\t * @returns {Controller}\n\t */\n\toptions( options ) {\n\t\tconst controller = this.parent.add( this.object, this.property, options );\n\t\tcontroller.name( this._name );\n\t\tthis.destroy();\n\t\treturn controller;\n\t}\n\n\t/**\n\t * Sets the minimum value. Only works on number controllers.\n\t * @param {number} min\n\t * @returns {this}\n\t */\n\tmin( min ) {\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets the maximum value. Only works on number controllers.\n\t * @param {number} max\n\t * @returns {this}\n\t */\n\tmax( max ) {\n\t\treturn this;\n\t}\n\n\t/**\n\t * Values set by this controller will be rounded to multiples of `step`. Only works on number\n\t * controllers.\n\t * @param {number} step\n\t * @returns {this}\n\t */\n\tstep( step ) {\n\t\treturn this;\n\t}\n\n\t/**\n\t * Rounds the displayed value to a fixed number of decimals, without affecting the actual value\n\t * like `step()`. Only works on number controllers.\n\t * @example\n\t * gui.add( object, 'property' ).listen().decimals( 4 );\n\t * @param {number} decimals\n\t * @returns {this}\n\t */\n\tdecimals( decimals ) {\n\t\treturn this;\n\t}\n\n\t/**\n\t * Calls `updateDisplay()` every animation frame. Pass `false` to stop listening.\n\t * @param {boolean} listen\n\t * @returns {this}\n\t */\n\tlisten( listen = true ) {\n\n\t\t/**\n\t\t * Used to determine if the controller is currently listening. Don't modify this value\n\t\t * directly. Use the `controller.listen( true|false )` method instead.\n\t\t * @type {boolean}\n\t\t */\n\t\tthis._listening = listen;\n\n\t\tif ( this._listenCallbackID !== undefined ) {\n\t\t\tcancelAnimationFrame( this._listenCallbackID );\n\t\t\tthis._listenCallbackID = undefined;\n\t\t}\n\n\t\tif ( this._listening ) {\n\t\t\tthis._listenCallback();\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t_listenCallback() {\n\n\t\tthis._listenCallbackID = requestAnimationFrame( this._listenCallback );\n\n\t\t// To prevent framerate loss, make sure the value has changed before updating the display.\n\t\t// Note: save() is used here instead of getValue() only because of ColorController. The !== operator\n\t\t// won't work for color objects or arrays, but ColorController.save() always returns a string.\n\n\t\tconst curValue = this.save();\n\n\t\tif ( curValue !== this._listenPrevValue ) {\n\t\t\tthis.updateDisplay();\n\t\t}\n\n\t\tthis._listenPrevValue = curValue;\n\n\t}\n\n\t/**\n\t * Returns `object[ property ]`.\n\t * @returns {any}\n\t */\n\tgetValue() {\n\t\treturn this.object[ this.property ];\n\t}\n\n\t/**\n\t * Sets the value of `object[ property ]`, invokes any `onChange` handlers and updates the display.\n\t * @param {any} value\n\t * @returns {this}\n\t */\n\tsetValue( value ) {\n\n\t\tif ( this.getValue() !== value ) {\n\n\t\t\tthis.object[ this.property ] = value;\n\t\t\tthis._callOnChange();\n\t\t\tthis.updateDisplay();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Updates the display to keep it in sync with the current value. Useful for updating your\n\t * controllers when their values have been modified outside of the GUI.\n\t * @returns {this}\n\t */\n\tupdateDisplay() {\n\t\treturn this;\n\t}\n\n\tload( value ) {\n\t\tthis.setValue( value );\n\t\tthis._callOnFinishChange();\n\t\treturn this;\n\t}\n\n\tsave() {\n\t\treturn this.getValue();\n\t}\n\n\t/**\n\t * Destroys this controller and removes it from the parent GUI.\n\t */\n\tdestroy() {\n\t\tthis.listen( false );\n\t\tthis.parent.children.splice( this.parent.children.indexOf( this ), 1 );\n\t\tthis.parent.controllers.splice( this.parent.controllers.indexOf( this ), 1 );\n\t\tthis.parent.$children.removeChild( this.domElement );\n\t}\n\n}\n\nclass BooleanController extends Controller {\n\n\tconstructor( parent, object, property ) {\n\n\t\tsuper( parent, object, property, 'boolean', 'label' );\n\n\t\tthis.$input = document.createElement( 'input' );\n\t\tthis.$input.setAttribute( 'type', 'checkbox' );\n\t\tthis.$input.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$widget.appendChild( this.$input );\n\n\t\tthis.$input.addEventListener( 'change', () => {\n\t\t\tthis.setValue( this.$input.checked );\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$disable = this.$input;\n\n\t\tthis.updateDisplay();\n\n\t}\n\n\tupdateDisplay() {\n\t\tthis.$input.checked = this.getValue();\n\t\treturn this;\n\t}\n\n}\n\nfunction normalizeColorString( string ) {\n\n\tlet match, result;\n\n\tif ( match = string.match( /(#|0x)?([a-f0-9]{6})/i ) ) {\n\n\t\tresult = match[ 2 ];\n\n\t} else if ( match = string.match( /rgb\\(\\s*(\\d*)\\s*,\\s*(\\d*)\\s*,\\s*(\\d*)\\s*\\)/ ) ) {\n\n\t\tresult = parseInt( match[ 1 ] ).toString( 16 ).padStart( 2, 0 )\n\t\t\t+ parseInt( match[ 2 ] ).toString( 16 ).padStart( 2, 0 )\n\t\t\t+ parseInt( match[ 3 ] ).toString( 16 ).padStart( 2, 0 );\n\n\t} else if ( match = string.match( /^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i ) ) {\n\n\t\tresult = match[ 1 ] + match[ 1 ] + match[ 2 ] + match[ 2 ] + match[ 3 ] + match[ 3 ];\n\n\t}\n\n\tif ( result ) {\n\t\treturn '#' + result;\n\t}\n\n\treturn false;\n\n}\n\nconst STRING = {\n\tisPrimitive: true,\n\tmatch: v => typeof v === 'string',\n\tfromHexString: normalizeColorString,\n\ttoHexString: normalizeColorString\n};\n\nconst INT = {\n\tisPrimitive: true,\n\tmatch: v => typeof v === 'number',\n\tfromHexString: string => parseInt( string.substring( 1 ), 16 ),\n\ttoHexString: value => '#' + value.toString( 16 ).padStart( 6, 0 )\n};\n\nconst ARRAY = {\n\tisPrimitive: false,\n\n\t// The arrow function is here to appease tree shakers like esbuild or webpack.\n\t// See https://esbuild.github.io/api/#tree-shaking\n\tmatch: v => Array.isArray( v ),\n\n\tfromHexString( string, target, rgbScale = 1 ) {\n\n\t\tconst int = INT.fromHexString( string );\n\n\t\ttarget[ 0 ] = ( int >> 16 & 255 ) / 255 * rgbScale;\n\t\ttarget[ 1 ] = ( int >> 8 & 255 ) / 255 * rgbScale;\n\t\ttarget[ 2 ] = ( int & 255 ) / 255 * rgbScale;\n\n\t},\n\ttoHexString( [ r, g, b ], rgbScale = 1 ) {\n\n\t\trgbScale = 255 / rgbScale;\n\n\t\tconst int = ( r * rgbScale ) << 16 ^\n\t\t\t( g * rgbScale ) << 8 ^\n\t\t\t( b * rgbScale ) << 0;\n\n\t\treturn INT.toHexString( int );\n\n\t}\n};\n\nconst OBJECT = {\n\tisPrimitive: false,\n\tmatch: v => Object( v ) === v,\n\tfromHexString( string, target, rgbScale = 1 ) {\n\n\t\tconst int = INT.fromHexString( string );\n\n\t\ttarget.r = ( int >> 16 & 255 ) / 255 * rgbScale;\n\t\ttarget.g = ( int >> 8 & 255 ) / 255 * rgbScale;\n\t\ttarget.b = ( int & 255 ) / 255 * rgbScale;\n\n\t},\n\ttoHexString( { r, g, b }, rgbScale = 1 ) {\n\n\t\trgbScale = 255 / rgbScale;\n\n\t\tconst int = ( r * rgbScale ) << 16 ^\n\t\t\t( g * rgbScale ) << 8 ^\n\t\t\t( b * rgbScale ) << 0;\n\n\t\treturn INT.toHexString( int );\n\n\t}\n};\n\nconst FORMATS = [ STRING, INT, ARRAY, OBJECT ];\n\nfunction getColorFormat( value ) {\n\treturn FORMATS.find( format => format.match( value ) );\n}\n\nclass ColorController extends Controller {\n\n\tconstructor( parent, object, property, rgbScale ) {\n\n\t\tsuper( parent, object, property, 'color' );\n\n\t\tthis.$input = document.createElement( 'input' );\n\t\tthis.$input.setAttribute( 'type', 'color' );\n\t\tthis.$input.setAttribute( 'tabindex', -1 );\n\t\tthis.$input.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$text = document.createElement( 'input' );\n\t\tthis.$text.setAttribute( 'type', 'text' );\n\t\tthis.$text.setAttribute( 'spellcheck', 'false' );\n\t\tthis.$text.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$display = document.createElement( 'div' );\n\t\tthis.$display.classList.add( 'display' );\n\n\t\tthis.$display.appendChild( this.$input );\n\t\tthis.$widget.appendChild( this.$display );\n\t\tthis.$widget.appendChild( this.$text );\n\n\t\tthis._format = getColorFormat( this.initialValue );\n\t\tthis._rgbScale = rgbScale;\n\n\t\tthis._initialValueHexString = this.save();\n\t\tthis._textFocused = false;\n\n\t\tthis.$input.addEventListener( 'input', () => {\n\t\t\tthis._setValueFromHexString( this.$input.value );\n\t\t} );\n\n\t\tthis.$input.addEventListener( 'blur', () => {\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$text.addEventListener( 'input', () => {\n\t\t\tconst tryParse = normalizeColorString( this.$text.value );\n\t\t\tif ( tryParse ) {\n\t\t\t\tthis._setValueFromHexString( tryParse );\n\t\t\t}\n\t\t} );\n\n\t\tthis.$text.addEventListener( 'focus', () => {\n\t\t\tthis._textFocused = true;\n\t\t\tthis.$text.select();\n\t\t} );\n\n\t\tthis.$text.addEventListener( 'blur', () => {\n\t\t\tthis._textFocused = false;\n\t\t\tthis.updateDisplay();\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$disable = this.$text;\n\n\t\tthis.updateDisplay();\n\n\t}\n\n\treset() {\n\t\tthis._setValueFromHexString( this._initialValueHexString );\n\t\treturn this;\n\t}\n\n\t_setValueFromHexString( value ) {\n\n\t\tif ( this._format.isPrimitive ) {\n\n\t\t\tconst newValue = this._format.fromHexString( value );\n\t\t\tthis.setValue( newValue );\n\n\t\t} else {\n\n\t\t\tthis._format.fromHexString( value, this.getValue(), this._rgbScale );\n\t\t\tthis._callOnChange();\n\t\t\tthis.updateDisplay();\n\n\t\t}\n\n\t}\n\n\tsave() {\n\t\treturn this._format.toHexString( this.getValue(), this._rgbScale );\n\t}\n\n\tload( value ) {\n\t\tthis._setValueFromHexString( value );\n\t\tthis._callOnFinishChange();\n\t\treturn this;\n\t}\n\n\tupdateDisplay() {\n\t\tthis.$input.value = this._format.toHexString( this.getValue(), this._rgbScale );\n\t\tif ( !this._textFocused ) {\n\t\t\tthis.$text.value = this.$input.value.substring( 1 );\n\t\t}\n\t\tthis.$display.style.backgroundColor = this.$input.value;\n\t\treturn this;\n\t}\n\n}\n\nclass FunctionController extends Controller {\n\n\tconstructor( parent, object, property ) {\n\n\t\tsuper( parent, object, property, 'function' );\n\n\t\t// Buttons are the only case where widget contains name\n\t\tthis.$button = document.createElement( 'button' );\n\t\tthis.$button.appendChild( this.$name );\n\t\tthis.$widget.appendChild( this.$button );\n\n\t\tthis.$button.addEventListener( 'click', e => {\n\t\t\te.preventDefault();\n\t\t\tthis.getValue().call( this.object );\n\t\t\tthis._callOnChange();\n\t\t} );\n\n\t\t// enables :active pseudo class on mobile\n\t\tthis.$button.addEventListener( 'touchstart', () => {}, { passive: true } );\n\n\t\tthis.$disable = this.$button;\n\n\t}\n\n}\n\nclass NumberController extends Controller {\n\n\tconstructor( parent, object, property, min, max, step ) {\n\n\t\tsuper( parent, object, property, 'number' );\n\n\t\tthis._initInput();\n\n\t\tthis.min( min );\n\t\tthis.max( max );\n\n\t\tconst stepExplicit = step !== undefined;\n\t\tthis.step( stepExplicit ? step : this._getImplicitStep(), stepExplicit );\n\n\t\tthis.updateDisplay();\n\n\t}\n\n\tdecimals( decimals ) {\n\t\tthis._decimals = decimals;\n\t\tthis.updateDisplay();\n\t\treturn this;\n\t}\n\n\tmin( min ) {\n\t\tthis._min = min;\n\t\tthis._onUpdateMinMax();\n\t\treturn this;\n\t}\n\n\tmax( max ) {\n\t\tthis._max = max;\n\t\tthis._onUpdateMinMax();\n\t\treturn this;\n\t}\n\n\tstep( step, explicit = true ) {\n\t\tthis._step = step;\n\t\tthis._stepExplicit = explicit;\n\t\treturn this;\n\t}\n\n\tupdateDisplay() {\n\n\t\tconst value = this.getValue();\n\n\t\tif ( this._hasSlider ) {\n\n\t\t\tlet percent = ( value - this._min ) / ( this._max - this._min );\n\t\t\tpercent = Math.max( 0, Math.min( percent, 1 ) );\n\n\t\t\tthis.$fill.style.width = percent * 100 + '%';\n\n\t\t}\n\n\t\tif ( !this._inputFocused ) {\n\t\t\tthis.$input.value = this._decimals === undefined ? value : value.toFixed( this._decimals );\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t_initInput() {\n\n\t\tthis.$input = document.createElement( 'input' );\n\t\tthis.$input.setAttribute( 'type', 'text' );\n\t\tthis.$input.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\t// On touch devices only, use input[type=number] to force a numeric keyboard.\n\t\t// Ideally we could use one input type everywhere, but [type=number] has quirks\n\t\t// on desktop, and [inputmode=decimal] has quirks on iOS.\n\t\t// See https://github.com/georgealways/lil-gui/pull/16\n\n\t\tconst isTouch = window.matchMedia( '(pointer: coarse)' ).matches;\n\n\t\tif ( isTouch ) {\n\t\t\tthis.$input.setAttribute( 'type', 'number' );\n\t\t\tthis.$input.setAttribute( 'step', 'any' );\n\t\t}\n\n\t\tthis.$widget.appendChild( this.$input );\n\n\t\tthis.$disable = this.$input;\n\n\t\tconst onInput = () => {\n\n\t\t\tlet value = parseFloat( this.$input.value );\n\n\t\t\tif ( isNaN( value ) ) return;\n\n\t\t\tif ( this._stepExplicit ) {\n\t\t\t\tvalue = this._snap( value );\n\t\t\t}\n\n\t\t\tthis.setValue( this._clamp( value ) );\n\n\t\t};\n\n\t\t// Keys & mouse wheel\n\t\t// ---------------------------------------------------------------------\n\n\t\tconst increment = delta => {\n\n\t\t\tconst value = parseFloat( this.$input.value );\n\n\t\t\tif ( isNaN( value ) ) return;\n\n\t\t\tthis._snapClampSetValue( value + delta );\n\n\t\t\t// Force the input to updateDisplay when it's focused\n\t\t\tthis.$input.value = this.getValue();\n\n\t\t};\n\n\t\tconst onKeyDown = e => {\n\t\t\t// Using `e.key` instead of `e.code` also catches NumpadEnter\n\t\t\tif ( e.key === 'Enter' ) {\n\t\t\t\tthis.$input.blur();\n\t\t\t}\n\t\t\tif ( e.code === 'ArrowUp' ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tincrement( this._step * this._arrowKeyMultiplier( e ) );\n\t\t\t}\n\t\t\tif ( e.code === 'ArrowDown' ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tincrement( this._step * this._arrowKeyMultiplier( e ) * -1 );\n\t\t\t}\n\t\t};\n\n\t\tconst onWheel = e => {\n\t\t\tif ( this._inputFocused ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tincrement( this._step * this._normalizeMouseWheel( e ) );\n\t\t\t}\n\t\t};\n\n\t\t// Vertical drag\n\t\t// ---------------------------------------------------------------------\n\n\t\tlet testingForVerticalDrag = false,\n\t\t\tinitClientX,\n\t\t\tinitClientY,\n\t\t\tprevClientY,\n\t\t\tinitValue,\n\t\t\tdragDelta;\n\n\t\t// Once the mouse is dragged more than DRAG_THRESH px on any axis, we decide\n\t\t// on the user's intent: horizontal means highlight, vertical means drag.\n\t\tconst DRAG_THRESH = 5;\n\n\t\tconst onMouseDown = e => {\n\n\t\t\tinitClientX = e.clientX;\n\t\t\tinitClientY = prevClientY = e.clientY;\n\t\t\ttestingForVerticalDrag = true;\n\n\t\t\tinitValue = this.getValue();\n\t\t\tdragDelta = 0;\n\n\t\t\twindow.addEventListener( 'mousemove', onMouseMove );\n\t\t\twindow.addEventListener( 'mouseup', onMouseUp );\n\n\t\t};\n\n\t\tconst onMouseMove = e => {\n\n\t\t\tif ( testingForVerticalDrag ) {\n\n\t\t\t\tconst dx = e.clientX - initClientX;\n\t\t\t\tconst dy = e.clientY - initClientY;\n\n\t\t\t\tif ( Math.abs( dy ) > DRAG_THRESH ) {\n\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.$input.blur();\n\t\t\t\t\ttestingForVerticalDrag = false;\n\t\t\t\t\tthis._setDraggingStyle( true, 'vertical' );\n\n\t\t\t\t} else if ( Math.abs( dx ) > DRAG_THRESH ) {\n\n\t\t\t\t\tonMouseUp();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// This isn't an else so that the first move counts towards dragDelta\n\t\t\tif ( !testingForVerticalDrag ) {\n\n\t\t\t\tconst dy = e.clientY - prevClientY;\n\n\t\t\t\tdragDelta -= dy * this._step * this._arrowKeyMultiplier( e );\n\n\t\t\t\t// Clamp dragDelta so we don't have 'dead space' after dragging past bounds.\n\t\t\t\t// We're okay with the fact that bounds can be undefined here.\n\t\t\t\tif ( initValue + dragDelta > this._max ) {\n\t\t\t\t\tdragDelta = this._max - initValue;\n\t\t\t\t} else if ( initValue + dragDelta < this._min ) {\n\t\t\t\t\tdragDelta = this._min - initValue;\n\t\t\t\t}\n\n\t\t\t\tthis._snapClampSetValue( initValue + dragDelta );\n\n\t\t\t}\n\n\t\t\tprevClientY = e.clientY;\n\n\t\t};\n\n\t\tconst onMouseUp = () => {\n\t\t\tthis._setDraggingStyle( false, 'vertical' );\n\t\t\tthis._callOnFinishChange();\n\t\t\twindow.removeEventListener( 'mousemove', onMouseMove );\n\t\t\twindow.removeEventListener( 'mouseup', onMouseUp );\n\t\t};\n\n\t\t// Focus state & onFinishChange\n\t\t// ---------------------------------------------------------------------\n\n\t\tconst onFocus = () => {\n\t\t\tthis._inputFocused = true;\n\t\t};\n\n\t\tconst onBlur = () => {\n\t\t\tthis._inputFocused = false;\n\t\t\tthis.updateDisplay();\n\t\t\tthis._callOnFinishChange();\n\t\t};\n\n\t\tthis.$input.addEventListener( 'input', onInput );\n\t\tthis.$input.addEventListener( 'keydown', onKeyDown );\n\t\tthis.$input.addEventListener( 'wheel', onWheel, { passive: false } );\n\t\tthis.$input.addEventListener( 'mousedown', onMouseDown );\n\t\tthis.$input.addEventListener( 'focus', onFocus );\n\t\tthis.$input.addEventListener( 'blur', onBlur );\n\n\t}\n\n\t_initSlider() {\n\n\t\tthis._hasSlider = true;\n\n\t\t// Build DOM\n\t\t// ---------------------------------------------------------------------\n\n\t\tthis.$slider = document.createElement( 'div' );\n\t\tthis.$slider.classList.add( 'slider' );\n\n\t\tthis.$fill = document.createElement( 'div' );\n\t\tthis.$fill.classList.add( 'fill' );\n\n\t\tthis.$slider.appendChild( this.$fill );\n\t\tthis.$widget.insertBefore( this.$slider, this.$input );\n\n\t\tthis.domElement.classList.add( 'hasSlider' );\n\n\t\t// Map clientX to value\n\t\t// ---------------------------------------------------------------------\n\n\t\tconst map = ( v, a, b, c, d ) => {\n\t\t\treturn ( v - a ) / ( b - a ) * ( d - c ) + c;\n\t\t};\n\n\t\tconst setValueFromX = clientX => {\n\t\t\tconst rect = this.$slider.getBoundingClientRect();\n\t\t\tlet value = map( clientX, rect.left, rect.right, this._min, this._max );\n\t\t\tthis._snapClampSetValue( value );\n\t\t};\n\n\t\t// Mouse drag\n\t\t// ---------------------------------------------------------------------\n\n\t\tconst mouseDown = e => {\n\t\t\tthis._setDraggingStyle( true );\n\t\t\tsetValueFromX( e.clientX );\n\t\t\twindow.addEventListener( 'mousemove', mouseMove );\n\t\t\twindow.addEventListener( 'mouseup', mouseUp );\n\t\t};\n\n\t\tconst mouseMove = e => {\n\t\t\tsetValueFromX( e.clientX );\n\t\t};\n\n\t\tconst mouseUp = () => {\n\t\t\tthis._callOnFinishChange();\n\t\t\tthis._setDraggingStyle( false );\n\t\t\twindow.removeEventListener( 'mousemove', mouseMove );\n\t\t\twindow.removeEventListener( 'mouseup', mouseUp );\n\t\t};\n\n\t\t// Touch drag\n\t\t// ---------------------------------------------------------------------\n\n\t\tlet testingForScroll = false, prevClientX, prevClientY;\n\n\t\tconst beginTouchDrag = e => {\n\t\t\te.preventDefault();\n\t\t\tthis._setDraggingStyle( true );\n\t\t\tsetValueFromX( e.touches[ 0 ].clientX );\n\t\t\ttestingForScroll = false;\n\t\t};\n\n\t\tconst onTouchStart = e => {\n\n\t\t\tif ( e.touches.length > 1 ) return;\n\n\t\t\t// If we're in a scrollable container, we should wait for the first\n\t\t\t// touchmove to see if the user is trying to slide or scroll.\n\t\t\tif ( this._hasScrollBar ) {\n\n\t\t\t\tprevClientX = e.touches[ 0 ].clientX;\n\t\t\t\tprevClientY = e.touches[ 0 ].clientY;\n\t\t\t\ttestingForScroll = true;\n\n\t\t\t} else {\n\n\t\t\t\t// Otherwise, we can set the value straight away on touchstart.\n\t\t\t\tbeginTouchDrag( e );\n\n\t\t\t}\n\n\t\t\twindow.addEventListener( 'touchmove', onTouchMove, { passive: false } );\n\t\t\twindow.addEventListener( 'touchend', onTouchEnd );\n\n\t\t};\n\n\t\tconst onTouchMove = e => {\n\n\t\t\tif ( testingForScroll ) {\n\n\t\t\t\tconst dx = e.touches[ 0 ].clientX - prevClientX;\n\t\t\t\tconst dy = e.touches[ 0 ].clientY - prevClientY;\n\n\t\t\t\tif ( Math.abs( dx ) > Math.abs( dy ) ) {\n\n\t\t\t\t\t// We moved horizontally, set the value and stop checking.\n\t\t\t\t\tbeginTouchDrag( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// This was, in fact, an attempt to scroll. Abort.\n\t\t\t\t\twindow.removeEventListener( 'touchmove', onTouchMove );\n\t\t\t\t\twindow.removeEventListener( 'touchend', onTouchEnd );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\te.preventDefault();\n\t\t\t\tsetValueFromX( e.touches[ 0 ].clientX );\n\n\t\t\t}\n\n\t\t};\n\n\t\tconst onTouchEnd = () => {\n\t\t\tthis._callOnFinishChange();\n\t\t\tthis._setDraggingStyle( false );\n\t\t\twindow.removeEventListener( 'touchmove', onTouchMove );\n\t\t\twindow.removeEventListener( 'touchend', onTouchEnd );\n\t\t};\n\n\t\t// Mouse wheel\n\t\t// ---------------------------------------------------------------------\n\n\t\t// We have to use a debounced function to call onFinishChange because\n\t\t// there's no way to tell when the user is \"done\" mouse-wheeling.\n\t\tconst callOnFinishChange = this._callOnFinishChange.bind( this );\n\t\tconst WHEEL_DEBOUNCE_TIME = 400;\n\t\tlet wheelFinishChangeTimeout;\n\n\t\tconst onWheel = e => {\n\n\t\t\t// ignore vertical wheels if there's a scrollbar\n\t\t\tconst isVertical = Math.abs( e.deltaX ) < Math.abs( e.deltaY );\n\t\t\tif ( isVertical && this._hasScrollBar ) return;\n\n\t\t\te.preventDefault();\n\n\t\t\t// set value\n\t\t\tconst delta = this._normalizeMouseWheel( e ) * this._step;\n\t\t\tthis._snapClampSetValue( this.getValue() + delta );\n\n\t\t\t// force the input to updateDisplay when it's focused\n\t\t\tthis.$input.value = this.getValue();\n\n\t\t\t// debounce onFinishChange\n\t\t\tclearTimeout( wheelFinishChangeTimeout );\n\t\t\twheelFinishChangeTimeout = setTimeout( callOnFinishChange, WHEEL_DEBOUNCE_TIME );\n\n\t\t};\n\n\t\tthis.$slider.addEventListener( 'mousedown', mouseDown );\n\t\tthis.$slider.addEventListener( 'touchstart', onTouchStart, { passive: false } );\n\t\tthis.$slider.addEventListener( 'wheel', onWheel, { passive: false } );\n\n\t}\n\n\t_setDraggingStyle( active, axis = 'horizontal' ) {\n\t\tif ( this.$slider ) {\n\t\t\tthis.$slider.classList.toggle( 'active', active );\n\t\t}\n\t\tdocument.body.classList.toggle( 'lil-gui-dragging', active );\n\t\tdocument.body.classList.toggle( `lil-gui-${axis}`, active );\n\t}\n\n\t_getImplicitStep() {\n\n\t\tif ( this._hasMin && this._hasMax ) {\n\t\t\treturn ( this._max - this._min ) / 1000;\n\t\t}\n\n\t\treturn 0.1;\n\n\t}\n\n\t_onUpdateMinMax() {\n\n\t\tif ( !this._hasSlider && this._hasMin && this._hasMax ) {\n\n\t\t\t// If this is the first time we're hearing about min and max\n\t\t\t// and we haven't explicitly stated what our step is, let's\n\t\t\t// update that too.\n\t\t\tif ( !this._stepExplicit ) {\n\t\t\t\tthis.step( this._getImplicitStep(), false );\n\t\t\t}\n\n\t\t\tthis._initSlider();\n\t\t\tthis.updateDisplay();\n\n\t\t}\n\n\t}\n\n\t_normalizeMouseWheel( e ) {\n\n\t\tlet { deltaX, deltaY } = e;\n\n\t\t// Safari and Chrome report weird non-integral values for a notched wheel,\n\t\t// but still expose actual lines scrolled via wheelDelta. Notched wheels\n\t\t// should behave the same way as arrow keys.\n\t\tif ( Math.floor( e.deltaY ) !== e.deltaY && e.wheelDelta ) {\n\t\t\tdeltaX = 0;\n\t\t\tdeltaY = -e.wheelDelta / 120;\n\t\t\tdeltaY *= this._stepExplicit ? 1 : 10;\n\t\t}\n\n\t\tconst wheel = deltaX + -deltaY;\n\n\t\treturn wheel;\n\n\t}\n\n\t_arrowKeyMultiplier( e ) {\n\n\t\tlet mult = this._stepExplicit ? 1 : 10;\n\n\t\tif ( e.shiftKey ) {\n\t\t\tmult *= 10;\n\t\t} else if ( e.altKey ) {\n\t\t\tmult /= 10;\n\t\t}\n\n\t\treturn mult;\n\n\t}\n\n\t_snap( value ) {\n\n\t\t// This would be the logical way to do things, but floating point errors.\n\t\t// return Math.round( value / this._step ) * this._step;\n\n\t\t// Using inverse step solves a lot of them, but not all\n\t\t// const inverseStep = 1 / this._step;\n\t\t// return Math.round( value * inverseStep ) / inverseStep;\n\n\t\t// Not happy about this, but haven't seen it break.\n\t\tconst r = Math.round( value / this._step ) * this._step;\n\t\treturn parseFloat( r.toPrecision( 15 ) );\n\n\t}\n\n\t_clamp( value ) {\n\t\t// either condition is false if min or max is undefined\n\t\tif ( value < this._min ) value = this._min;\n\t\tif ( value > this._max ) value = this._max;\n\t\treturn value;\n\t}\n\n\t_snapClampSetValue( value ) {\n\t\tthis.setValue( this._clamp( this._snap( value ) ) );\n\t}\n\n\tget _hasScrollBar() {\n\t\tconst root = this.parent.root.$children;\n\t\treturn root.scrollHeight > root.clientHeight;\n\t}\n\n\tget _hasMin() {\n\t\treturn this._min !== undefined;\n\t}\n\n\tget _hasMax() {\n\t\treturn this._max !== undefined;\n\t}\n\n}\n\nclass OptionController extends Controller {\n\n\tconstructor( parent, object, property, options ) {\n\n\t\tsuper( parent, object, property, 'option' );\n\n\t\tthis.$select = document.createElement( 'select' );\n\t\tthis.$select.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$display = document.createElement( 'div' );\n\t\tthis.$display.classList.add( 'display' );\n\n\t\tthis.$select.addEventListener( 'change', () => {\n\t\t\tthis.setValue( this._values[ this.$select.selectedIndex ] );\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$select.addEventListener( 'focus', () => {\n\t\t\tthis.$display.classList.add( 'focus' );\n\t\t} );\n\n\t\tthis.$select.addEventListener( 'blur', () => {\n\t\t\tthis.$display.classList.remove( 'focus' );\n\t\t} );\n\n\t\tthis.$widget.appendChild( this.$select );\n\t\tthis.$widget.appendChild( this.$display );\n\n\t\tthis.$disable = this.$select;\n\n\t\tthis.options( options );\n\n\t}\n\n\toptions( options ) {\n\n\t\tthis._values = Array.isArray( options ) ? options : Object.values( options );\n\t\tthis._names = Array.isArray( options ) ? options : Object.keys( options );\n\n\t\tthis.$select.replaceChildren();\n\n\t\tthis._names.forEach( name => {\n\t\t\tconst $option = document.createElement( 'option' );\n\t\t\t$option.textContent = name;\n\t\t\tthis.$select.appendChild( $option );\n\t\t} );\n\n\t\tthis.updateDisplay();\n\n\t\treturn this;\n\n\t}\n\n\tupdateDisplay() {\n\t\tconst value = this.getValue();\n\t\tconst index = this._values.indexOf( value );\n\t\tthis.$select.selectedIndex = index;\n\t\tthis.$display.textContent = index === -1 ? value : this._names[ index ];\n\t\treturn this;\n\t}\n\n}\n\nclass StringController extends Controller {\n\n\tconstructor( parent, object, property ) {\n\n\t\tsuper( parent, object, property, 'string' );\n\n\t\tthis.$input = document.createElement( 'input' );\n\t\tthis.$input.setAttribute( 'type', 'text' );\n\t\tthis.$input.setAttribute( 'spellcheck', 'false' );\n\t\tthis.$input.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$input.addEventListener( 'input', () => {\n\t\t\tthis.setValue( this.$input.value );\n\t\t} );\n\n\t\tthis.$input.addEventListener( 'keydown', e => {\n\t\t\tif ( e.code === 'Enter' ) {\n\t\t\t\tthis.$input.blur();\n\t\t\t}\n\t\t} );\n\n\t\tthis.$input.addEventListener( 'blur', () => {\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$widget.appendChild( this.$input );\n\n\t\tthis.$disable = this.$input;\n\n\t\tthis.updateDisplay();\n\n\t}\n\n\tupdateDisplay() {\n\t\tthis.$input.value = this.getValue();\n\t\treturn this;\n\t}\n\n}\n\nconst stylesheet = `.lil-gui {\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  line-height: 1;\n  font-weight: normal;\n  font-style: normal;\n  text-align: left;\n  color: var(--text-color);\n  user-select: none;\n  -webkit-user-select: none;\n  touch-action: manipulation;\n  --background-color: #1f1f1f;\n  --text-color: #ebebeb;\n  --title-background-color: #111111;\n  --title-text-color: #ebebeb;\n  --widget-color: #424242;\n  --hover-color: #4f4f4f;\n  --focus-color: #595959;\n  --number-color: #2cc9ff;\n  --string-color: #a2db3c;\n  --font-size: 11px;\n  --input-font-size: 11px;\n  --font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Arial, sans-serif;\n  --font-family-mono: Menlo, Monaco, Consolas, \"Droid Sans Mono\", monospace;\n  --padding: 4px;\n  --spacing: 4px;\n  --widget-height: 20px;\n  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);\n  --name-width: 45%;\n  --slider-knob-width: 2px;\n  --slider-input-width: 27%;\n  --color-input-width: 27%;\n  --slider-input-min-width: 45px;\n  --color-input-min-width: 45px;\n  --folder-indent: 7px;\n  --widget-padding: 0 0 0 3px;\n  --widget-border-radius: 2px;\n  --checkbox-size: calc(0.75 * var(--widget-height));\n  --scrollbar-width: 5px;\n}\n.lil-gui, .lil-gui * {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.lil-gui.root {\n  width: var(--width, 245px);\n  display: flex;\n  flex-direction: column;\n  background: var(--background-color);\n}\n.lil-gui.root > .title {\n  background: var(--title-background-color);\n  color: var(--title-text-color);\n}\n.lil-gui.root > .children {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.lil-gui.root > .children::-webkit-scrollbar {\n  width: var(--scrollbar-width);\n  height: var(--scrollbar-width);\n  background: var(--background-color);\n}\n.lil-gui.root > .children::-webkit-scrollbar-thumb {\n  border-radius: var(--scrollbar-width);\n  background: var(--focus-color);\n}\n@media (pointer: coarse) {\n  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {\n    --widget-height: 28px;\n    --padding: 6px;\n    --spacing: 6px;\n    --font-size: 13px;\n    --input-font-size: 16px;\n    --folder-indent: 10px;\n    --scrollbar-width: 7px;\n    --slider-input-min-width: 50px;\n    --color-input-min-width: 65px;\n  }\n}\n.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {\n  --widget-height: 28px;\n  --padding: 6px;\n  --spacing: 6px;\n  --font-size: 13px;\n  --input-font-size: 16px;\n  --folder-indent: 10px;\n  --scrollbar-width: 7px;\n  --slider-input-min-width: 50px;\n  --color-input-min-width: 65px;\n}\n.lil-gui.autoPlace {\n  max-height: 100%;\n  position: fixed;\n  top: 0;\n  right: 15px;\n  z-index: 1001;\n}\n\n.lil-gui .controller {\n  display: flex;\n  align-items: center;\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n}\n.lil-gui .controller.disabled {\n  opacity: 0.5;\n}\n.lil-gui .controller.disabled, .lil-gui .controller.disabled * {\n  pointer-events: none !important;\n}\n.lil-gui .controller > .name {\n  min-width: var(--name-width);\n  flex-shrink: 0;\n  white-space: pre;\n  padding-right: var(--spacing);\n  line-height: var(--widget-height);\n}\n.lil-gui .controller .widget {\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  min-height: var(--widget-height);\n}\n.lil-gui .controller.string input {\n  color: var(--string-color);\n}\n.lil-gui .controller.boolean {\n  cursor: pointer;\n}\n.lil-gui .controller.color .display {\n  width: 100%;\n  height: var(--widget-height);\n  border-radius: var(--widget-border-radius);\n  position: relative;\n}\n@media (hover: hover) {\n  .lil-gui .controller.color .display:hover:before {\n    content: \" \";\n    display: block;\n    position: absolute;\n    border-radius: var(--widget-border-radius);\n    border: 1px solid #fff9;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n  }\n}\n.lil-gui .controller.color input[type=color] {\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n}\n.lil-gui .controller.color input[type=text] {\n  margin-left: var(--spacing);\n  font-family: var(--font-family-mono);\n  min-width: var(--color-input-min-width);\n  width: var(--color-input-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.option select {\n  opacity: 0;\n  position: absolute;\n  width: 100%;\n  max-width: 100%;\n}\n.lil-gui .controller.option .display {\n  position: relative;\n  pointer-events: none;\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  line-height: var(--widget-height);\n  max-width: 100%;\n  overflow: hidden;\n  word-break: break-all;\n  padding-left: 0.55em;\n  padding-right: 1.75em;\n  background: var(--widget-color);\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .display.focus {\n    background: var(--focus-color);\n  }\n}\n.lil-gui .controller.option .display.active {\n  background: var(--focus-color);\n}\n.lil-gui .controller.option .display:after {\n  font-family: \"lil-gui\";\n  content: \"\u2195\";\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  padding-right: 0.375em;\n}\n.lil-gui .controller.option .widget,\n.lil-gui .controller.option select {\n  cursor: pointer;\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .widget:hover .display {\n    background: var(--hover-color);\n  }\n}\n.lil-gui .controller.number input {\n  color: var(--number-color);\n}\n.lil-gui .controller.number.hasSlider input {\n  margin-left: var(--spacing);\n  width: var(--slider-input-width);\n  min-width: var(--slider-input-min-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.number .slider {\n  width: 100%;\n  height: var(--widget-height);\n  background: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  padding-right: var(--slider-knob-width);\n  overflow: hidden;\n  cursor: ew-resize;\n  touch-action: pan-y;\n}\n@media (hover: hover) {\n  .lil-gui .controller.number .slider:hover {\n    background: var(--hover-color);\n  }\n}\n.lil-gui .controller.number .slider.active {\n  background: var(--focus-color);\n}\n.lil-gui .controller.number .slider.active .fill {\n  opacity: 0.95;\n}\n.lil-gui .controller.number .fill {\n  height: 100%;\n  border-right: var(--slider-knob-width) solid var(--number-color);\n  box-sizing: content-box;\n}\n\n.lil-gui-dragging .lil-gui {\n  --hover-color: var(--widget-color);\n}\n.lil-gui-dragging * {\n  cursor: ew-resize !important;\n}\n\n.lil-gui-dragging.lil-gui-vertical * {\n  cursor: ns-resize !important;\n}\n\n.lil-gui .title {\n  height: var(--title-height);\n  line-height: calc(var(--title-height) - 4px);\n  font-weight: 600;\n  padding: 0 var(--padding);\n  -webkit-tap-highlight-color: transparent;\n  cursor: pointer;\n  outline: none;\n  text-decoration-skip: objects;\n}\n.lil-gui .title:before {\n  font-family: \"lil-gui\";\n  content: \"\u25BE\";\n  padding-right: 2px;\n  display: inline-block;\n}\n.lil-gui .title:active {\n  background: var(--title-background-color);\n  opacity: 0.75;\n}\n@media (hover: hover) {\n  body:not(.lil-gui-dragging) .lil-gui .title:hover {\n    background: var(--title-background-color);\n    opacity: 0.85;\n  }\n  .lil-gui .title:focus {\n    text-decoration: underline var(--focus-color);\n  }\n}\n.lil-gui.root > .title:focus {\n  text-decoration: none !important;\n}\n.lil-gui.closed > .title:before {\n  content: \"\u25B8\";\n}\n.lil-gui.closed > .children {\n  transform: translateY(-7px);\n  opacity: 0;\n}\n.lil-gui.closed:not(.transition) > .children {\n  display: none;\n}\n.lil-gui.transition > .children {\n  transition-duration: 300ms;\n  transition-property: height, opacity, transform;\n  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);\n  overflow: hidden;\n  pointer-events: none;\n}\n.lil-gui .children:empty:before {\n  content: \"Empty\";\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n  display: block;\n  height: var(--widget-height);\n  font-style: italic;\n  line-height: var(--widget-height);\n  opacity: 0.5;\n}\n.lil-gui.root > .children > .lil-gui > .title {\n  border: 0 solid var(--widget-color);\n  border-width: 1px 0;\n  transition: border-color 300ms;\n}\n.lil-gui.root > .children > .lil-gui.closed > .title {\n  border-bottom-color: transparent;\n}\n.lil-gui + .controller {\n  border-top: 1px solid var(--widget-color);\n  margin-top: 0;\n  padding-top: var(--spacing);\n}\n.lil-gui .lil-gui .lil-gui > .title {\n  border: none;\n}\n.lil-gui .lil-gui .lil-gui > .children {\n  border: none;\n  margin-left: var(--folder-indent);\n  border-left: 2px solid var(--widget-color);\n}\n.lil-gui .lil-gui .controller {\n  border: none;\n}\n\n.lil-gui label, .lil-gui input, .lil-gui button {\n  -webkit-tap-highlight-color: transparent;\n}\n.lil-gui input {\n  border: 0;\n  outline: none;\n  font-family: var(--font-family);\n  font-size: var(--input-font-size);\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  background: var(--widget-color);\n  color: var(--text-color);\n  width: 100%;\n}\n@media (hover: hover) {\n  .lil-gui input:hover {\n    background: var(--hover-color);\n  }\n  .lil-gui input:active {\n    background: var(--focus-color);\n  }\n}\n.lil-gui input:disabled {\n  opacity: 1;\n}\n.lil-gui input[type=text],\n.lil-gui input[type=number] {\n  padding: var(--widget-padding);\n  -moz-appearance: textfield;\n}\n.lil-gui input[type=text]:focus,\n.lil-gui input[type=number]:focus {\n  background: var(--focus-color);\n}\n.lil-gui input[type=checkbox] {\n  appearance: none;\n  width: var(--checkbox-size);\n  height: var(--checkbox-size);\n  border-radius: var(--widget-border-radius);\n  text-align: center;\n  cursor: pointer;\n}\n.lil-gui input[type=checkbox]:checked:before {\n  font-family: \"lil-gui\";\n  content: \"\u2713\";\n  font-size: var(--checkbox-size);\n  line-height: var(--checkbox-size);\n}\n@media (hover: hover) {\n  .lil-gui input[type=checkbox]:focus {\n    box-shadow: inset 0 0 0 1px var(--focus-color);\n  }\n}\n.lil-gui button {\n  outline: none;\n  cursor: pointer;\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  color: var(--text-color);\n  width: 100%;\n  height: var(--widget-height);\n  text-transform: none;\n  background: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  border: none;\n}\n@media (hover: hover) {\n  .lil-gui button:hover {\n    background: var(--hover-color);\n  }\n  .lil-gui button:focus {\n    box-shadow: inset 0 0 0 1px var(--focus-color);\n  }\n}\n.lil-gui button:active {\n  background: var(--focus-color);\n}\n\n@font-face {\n  font-family: \"lil-gui\";\n  src: url(\"data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==\") format(\"woff\");\n}`;\n\nfunction _injectStyles( cssContent ) {\n\tconst injected = document.createElement( 'style' );\n\tinjected.innerHTML = cssContent;\n\tconst before = document.querySelector( 'head link[rel=stylesheet], head style' );\n\tif ( before ) {\n\t\tdocument.head.insertBefore( injected, before );\n\t} else {\n\t\tdocument.head.appendChild( injected );\n\t}\n}\n\nlet stylesInjected = false;\n\nclass GUI {\n\n\t/**\n\t * Creates a panel that holds controllers.\n\t * @example\n\t * new GUI();\n\t * new GUI( { container: document.getElementById( 'custom' ) } );\n\t *\n\t * @param {object} [options]\n\t * @param {boolean} [options.autoPlace=true]\n\t * Adds the GUI to `document.body` and fixes it to the top right of the page.\n\t *\n\t * @param {HTMLElement} [options.container]\n\t * Adds the GUI to this DOM element. Overrides `autoPlace`.\n\t *\n\t * @param {number} [options.width=245]\n\t * Width of the GUI in pixels, usually set when name labels become too long. Note that you can make\n\t * name labels wider in CSS with `.lil\u2011gui { \u2011\u2011name\u2011width: 55% }`.\n\t *\n\t * @param {string} [options.title=Controls]\n\t * Name to display in the title bar.\n\t *\n\t * @param {boolean} [options.closeFolders=false]\n\t * Pass `true` to close all folders in this GUI by default.\n\t *\n\t * @param {boolean} [options.injectStyles=true]\n\t * Injects the default stylesheet into the page if this is the first GUI.\n\t * Pass `false` to use your own stylesheet.\n\t *\n\t * @param {number} [options.touchStyles=true]\n\t * Makes controllers larger on touch devices. Pass `false` to disable touch styles.\n\t *\n\t * @param {GUI} [options.parent]\n\t * Adds this GUI as a child in another GUI. Usually this is done for you by `addFolder()`.\n\t *\n\t */\n\tconstructor( {\n\t\tparent,\n\t\tautoPlace = parent === undefined,\n\t\tcontainer,\n\t\twidth,\n\t\ttitle = 'Controls',\n\t\tcloseFolders = false,\n\t\tinjectStyles = true,\n\t\ttouchStyles = true\n\t} = {} ) {\n\n\t\t/**\n\t\t * The GUI containing this folder, or `undefined` if this is the root GUI.\n\t\t * @type {GUI}\n\t\t */\n\t\tthis.parent = parent;\n\n\t\t/**\n\t\t * The top level GUI containing this folder, or `this` if this is the root GUI.\n\t\t * @type {GUI}\n\t\t */\n\t\tthis.root = parent ? parent.root : this;\n\n\t\t/**\n\t\t * The list of controllers and folders contained by this GUI.\n\t\t * @type {Array<GUI|Controller>}\n\t\t */\n\t\tthis.children = [];\n\n\t\t/**\n\t\t * The list of controllers contained by this GUI.\n\t\t * @type {Array<Controller>}\n\t\t */\n\t\tthis.controllers = [];\n\n\t\t/**\n\t\t * The list of folders contained by this GUI.\n\t\t * @type {Array<GUI>}\n\t\t */\n\t\tthis.folders = [];\n\n\t\t/**\n\t\t * Used to determine if the GUI is closed. Use `gui.open()` or `gui.close()` to change this.\n\t\t * @type {boolean}\n\t\t */\n\t\tthis._closed = false;\n\n\t\t/**\n\t\t * Used to determine if the GUI is hidden. Use `gui.show()` or `gui.hide()` to change this.\n\t\t * @type {boolean}\n\t\t */\n\t\tthis._hidden = false;\n\n\t\t/**\n\t\t * The outermost container element.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.domElement = document.createElement( 'div' );\n\t\tthis.domElement.classList.add( 'lil-gui' );\n\n\t\t/**\n\t\t * The DOM element that contains the title.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$title = document.createElement( 'div' );\n\t\tthis.$title.classList.add( 'title' );\n\t\tthis.$title.setAttribute( 'role', 'button' );\n\t\tthis.$title.setAttribute( 'aria-expanded', true );\n\t\tthis.$title.setAttribute( 'tabindex', 0 );\n\n\t\tthis.$title.addEventListener( 'click', () => this.openAnimated( this._closed ) );\n\t\tthis.$title.addEventListener( 'keydown', e => {\n\t\t\tif ( e.code === 'Enter' || e.code === 'Space' ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.$title.click();\n\t\t\t}\n\t\t} );\n\n\t\t// enables :active pseudo class on mobile\n\t\tthis.$title.addEventListener( 'touchstart', () => {}, { passive: true } );\n\n\t\t/**\n\t\t * The DOM element that contains children.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$children = document.createElement( 'div' );\n\t\tthis.$children.classList.add( 'children' );\n\n\t\tthis.domElement.appendChild( this.$title );\n\t\tthis.domElement.appendChild( this.$children );\n\n\t\tthis.title( title );\n\n\t\tif ( this.parent ) {\n\n\t\t\tthis.parent.children.push( this );\n\t\t\tthis.parent.folders.push( this );\n\n\t\t\tthis.parent.$children.appendChild( this.domElement );\n\n\t\t\t// Stop the constructor early, everything onward only applies to root GUI's\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.domElement.classList.add( 'root' );\n\n\t\tif ( touchStyles ) {\n\t\t\tthis.domElement.classList.add( 'allow-touch-styles' );\n\t\t}\n\n\t\t// Inject stylesheet if we haven't done that yet\n\t\tif ( !stylesInjected && injectStyles ) {\n\t\t\t_injectStyles( stylesheet );\n\t\t\tstylesInjected = true;\n\t\t}\n\n\t\tif ( container ) {\n\n\t\t\tcontainer.appendChild( this.domElement );\n\n\t\t} else if ( autoPlace ) {\n\n\t\t\tthis.domElement.classList.add( 'autoPlace' );\n\t\t\tdocument.body.appendChild( this.domElement );\n\n\t\t}\n\n\t\tif ( width ) {\n\t\t\tthis.domElement.style.setProperty( '--width', width + 'px' );\n\t\t}\n\n\t\tthis._closeFolders = closeFolders;\n\n\t}\n\n\t/**\n\t * Adds a controller to the GUI, inferring controller type using the `typeof` operator.\n\t * @example\n\t * gui.add( object, 'property' );\n\t * gui.add( object, 'number', 0, 100, 1 );\n\t * gui.add( object, 'options', [ 1, 2, 3 ] );\n\t *\n\t * @param {object} object The object the controller will modify.\n\t * @param {string} property Name of the property to control.\n\t * @param {number|object|Array} [$1] Minimum value for number controllers, or the set of\n\t * selectable values for a dropdown.\n\t * @param {number} [max] Maximum value for number controllers.\n\t * @param {number} [step] Step value for number controllers.\n\t * @returns {Controller}\n\t */\n\tadd( object, property, $1, max, step ) {\n\n\t\tif ( Object( $1 ) === $1 ) {\n\n\t\t\treturn new OptionController( this, object, property, $1 );\n\n\t\t}\n\n\t\tconst initialValue = object[ property ];\n\n\t\tswitch ( typeof initialValue ) {\n\n\t\t\tcase 'number':\n\n\t\t\t\treturn new NumberController( this, object, property, $1, max, step );\n\n\t\t\tcase 'boolean':\n\n\t\t\t\treturn new BooleanController( this, object, property );\n\n\t\t\tcase 'string':\n\n\t\t\t\treturn new StringController( this, object, property );\n\n\t\t\tcase 'function':\n\n\t\t\t\treturn new FunctionController( this, object, property );\n\n\t\t}\n\n\t\tconsole.error( `gui.add failed\n\tproperty:`, property, `\n\tobject:`, object, `\n\tvalue:`, initialValue );\n\n\t}\n\n\t/**\n\t * Adds a color controller to the GUI.\n\t * @example\n\t * params = {\n\t * \tcssColor: '#ff00ff',\n\t * \trgbColor: { r: 0, g: 0.2, b: 0.4 },\n\t * \tcustomRange: [ 0, 127, 255 ],\n\t * };\n\t *\n\t * gui.addColor( params, 'cssColor' );\n\t * gui.addColor( params, 'rgbColor' );\n\t * gui.addColor( params, 'customRange', 255 );\n\t *\n\t * @param {object} object The object the controller will modify.\n\t * @param {string} property Name of the property to control.\n\t * @param {number} rgbScale Maximum value for a color channel when using an RGB color. You may\n\t * need to set this to 255 if your colors are too bright.\n\t * @returns {Controller}\n\t */\n\taddColor( object, property, rgbScale = 1 ) {\n\t\treturn new ColorController( this, object, property, rgbScale );\n\t}\n\n\t/**\n\t * Adds a folder to the GUI, which is just another GUI. This method returns\n\t * the nested GUI so you can add controllers to it.\n\t * @example\n\t * const folder = gui.addFolder( 'Position' );\n\t * folder.add( position, 'x' );\n\t * folder.add( position, 'y' );\n\t * folder.add( position, 'z' );\n\t *\n\t * @param {string} title Name to display in the folder's title bar.\n\t * @returns {GUI}\n\t */\n\taddFolder( title ) {\n\t\tconst folder = new GUI( { parent: this, title } );\n\t\tif ( this.root._closeFolders ) folder.close();\n\t\treturn folder;\n\t}\n\n\t/**\n\t * Recalls values that were saved with `gui.save()`.\n\t * @param {object} obj\n\t * @param {boolean} recursive Pass false to exclude folders descending from this GUI.\n\t * @returns {this}\n\t */\n\tload( obj, recursive = true ) {\n\n\t\tif ( obj.controllers ) {\n\n\t\t\tthis.controllers.forEach( c => {\n\n\t\t\t\tif ( c instanceof FunctionController ) return;\n\n\t\t\t\tif ( c._name in obj.controllers ) {\n\t\t\t\t\tc.load( obj.controllers[ c._name ] );\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t\tif ( recursive && obj.folders ) {\n\n\t\t\tthis.folders.forEach( f => {\n\n\t\t\t\tif ( f._title in obj.folders ) {\n\t\t\t\t\tf.load( obj.folders[ f._title ] );\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Returns an object mapping controller names to values. The object can be passed to `gui.load()` to\n\t * recall these values.\n\t * @example\n\t * {\n\t * \tcontrollers: {\n\t * \t\tprop1: 1,\n\t * \t\tprop2: 'value',\n\t * \t\t...\n\t * \t},\n\t * \tfolders: {\n\t * \t\tfolderName1: { controllers, folders },\n\t * \t\tfolderName2: { controllers, folders }\n\t * \t\t...\n\t * \t}\n\t * }\n\t *\n\t * @param {boolean} recursive Pass false to exclude folders descending from this GUI.\n\t * @returns {object}\n\t */\n\tsave( recursive = true ) {\n\n\t\tconst obj = {\n\t\t\tcontrollers: {},\n\t\t\tfolders: {}\n\t\t};\n\n\t\tthis.controllers.forEach( c => {\n\n\t\t\tif ( c instanceof FunctionController ) return;\n\n\t\t\tif ( c._name in obj.controllers ) {\n\t\t\t\tthrow new Error( `Cannot save GUI with duplicate property \"${c._name}\"` );\n\t\t\t}\n\n\t\t\tobj.controllers[ c._name ] = c.save();\n\n\t\t} );\n\n\t\tif ( recursive ) {\n\n\t\t\tthis.folders.forEach( f => {\n\n\t\t\t\tif ( f._title in obj.folders ) {\n\t\t\t\t\tthrow new Error( `Cannot save GUI with duplicate folder \"${f._title}\"` );\n\t\t\t\t}\n\n\t\t\t\tobj.folders[ f._title ] = f.save();\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn obj;\n\n\t}\n\n\t/**\n\t * Opens a GUI or folder. GUI and folders are open by default.\n\t * @param {boolean} open Pass false to close.\n\t * @returns {this}\n\t * @example\n\t * gui.open(); // open\n\t * gui.open( false ); // close\n\t * gui.open( gui._closed ); // toggle\n\t */\n\topen( open = true ) {\n\n\t\tthis._setClosed( !open );\n\n\t\tthis.$title.setAttribute( 'aria-expanded', !this._closed );\n\t\tthis.domElement.classList.toggle( 'closed', this._closed );\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Closes the GUI.\n\t * @returns {this}\n\t */\n\tclose() {\n\t\treturn this.open( false );\n\t}\n\n\t_setClosed( closed ) {\n\t\tif ( this._closed === closed ) return;\n\t\tthis._closed = closed;\n\t\tthis._callOnOpenClose( this );\n\t}\n\n\t/**\n\t * Shows the GUI after it's been hidden.\n\t * @param {boolean} show\n\t * @returns {this}\n\t * @example\n\t * gui.show();\n\t * gui.show( false ); // hide\n\t * gui.show( gui._hidden ); // toggle\n\t */\n\tshow( show = true ) {\n\n\t\tthis._hidden = !show;\n\n\t\tthis.domElement.style.display = this._hidden ? 'none' : '';\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Hides the GUI.\n\t * @returns {this}\n\t */\n\thide() {\n\t\treturn this.show( false );\n\t}\n\n\topenAnimated( open = true ) {\n\n\t\t// set state immediately\n\t\tthis._setClosed( !open );\n\n\t\tthis.$title.setAttribute( 'aria-expanded', !this._closed );\n\n\t\t// wait for next frame to measure $children\n\t\trequestAnimationFrame( () => {\n\n\t\t\t// explicitly set initial height for transition\n\t\t\tconst initialHeight = this.$children.clientHeight;\n\t\t\tthis.$children.style.height = initialHeight + 'px';\n\n\t\t\tthis.domElement.classList.add( 'transition' );\n\n\t\t\tconst onTransitionEnd = e => {\n\t\t\t\tif ( e.target !== this.$children ) return;\n\t\t\t\tthis.$children.style.height = '';\n\t\t\t\tthis.domElement.classList.remove( 'transition' );\n\t\t\t\tthis.$children.removeEventListener( 'transitionend', onTransitionEnd );\n\t\t\t};\n\n\t\t\tthis.$children.addEventListener( 'transitionend', onTransitionEnd );\n\n\t\t\t// todo: this is wrong if children's scrollHeight makes for a gui taller than maxHeight\n\t\t\tconst targetHeight = !open ? 0 : this.$children.scrollHeight;\n\n\t\t\tthis.domElement.classList.toggle( 'closed', !open );\n\n\t\t\trequestAnimationFrame( () => {\n\t\t\t\tthis.$children.style.height = targetHeight + 'px';\n\t\t\t} );\n\n\t\t} );\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Change the title of this GUI.\n\t * @param {string} title\n\t * @returns {this}\n\t */\n\ttitle( title ) {\n\t\t/**\n\t\t * Current title of the GUI. Use `gui.title( 'Title' )` to modify this value.\n\t\t * @type {string}\n\t\t */\n\t\tthis._title = title;\n\t\tthis.$title.textContent = title;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Resets all controllers to their initial values.\n\t * @param {boolean} recursive Pass false to exclude folders descending from this GUI.\n\t * @returns {this}\n\t */\n\treset( recursive = true ) {\n\t\tconst controllers = recursive ? this.controllersRecursive() : this.controllers;\n\t\tcontrollers.forEach( c => c.reset() );\n\t\treturn this;\n\t}\n\n\t/**\n\t * Pass a function to be called whenever a controller in this GUI changes.\n\t * @param {function({object:object, property:string, value:any, controller:Controller})} callback\n\t * @returns {this}\n\t * @example\n\t * gui.onChange( event => {\n\t * \tevent.object     // object that was modified\n\t * \tevent.property   // string, name of property\n\t * \tevent.value      // new value of controller\n\t * \tevent.controller // controller that was modified\n\t * } );\n\t */\n\tonChange( callback ) {\n\t\t/**\n\t\t * Used to access the function bound to `onChange` events. Don't modify this value\n\t\t * directly. Use the `gui.onChange( callback )` method instead.\n\t\t * @type {Function}\n\t\t */\n\t\tthis._onChange = callback;\n\t\treturn this;\n\t}\n\n\t_callOnChange( controller ) {\n\n\t\tif ( this.parent ) {\n\t\t\tthis.parent._callOnChange( controller );\n\t\t}\n\n\t\tif ( this._onChange !== undefined ) {\n\t\t\tthis._onChange.call( this, {\n\t\t\t\tobject: controller.object,\n\t\t\t\tproperty: controller.property,\n\t\t\t\tvalue: controller.getValue(),\n\t\t\t\tcontroller\n\t\t\t} );\n\t\t}\n\t}\n\n\t/**\n\t * Pass a function to be called whenever a controller in this GUI has finished changing.\n\t * @param {function({object:object, property:string, value:any, controller:Controller})} callback\n\t * @returns {this}\n\t * @example\n\t * gui.onFinishChange( event => {\n\t * \tevent.object     // object that was modified\n\t * \tevent.property   // string, name of property\n\t * \tevent.value      // new value of controller\n\t * \tevent.controller // controller that was modified\n\t * } );\n\t */\n\tonFinishChange( callback ) {\n\t\t/**\n\t\t * Used to access the function bound to `onFinishChange` events. Don't modify this value\n\t\t * directly. Use the `gui.onFinishChange( callback )` method instead.\n\t\t * @type {Function}\n\t\t */\n\t\tthis._onFinishChange = callback;\n\t\treturn this;\n\t}\n\n\t_callOnFinishChange( controller ) {\n\n\t\tif ( this.parent ) {\n\t\t\tthis.parent._callOnFinishChange( controller );\n\t\t}\n\n\t\tif ( this._onFinishChange !== undefined ) {\n\t\t\tthis._onFinishChange.call( this, {\n\t\t\t\tobject: controller.object,\n\t\t\t\tproperty: controller.property,\n\t\t\t\tvalue: controller.getValue(),\n\t\t\t\tcontroller\n\t\t\t} );\n\t\t}\n\t}\n\n\t/**\n\t * Pass a function to be called when this GUI or its descendants are opened or closed.\n\t * @param {function(GUI)} callback\n\t * @returns {this}\n\t * @example\n\t * gui.onOpenClose( changedGUI => {\n\t * \tconsole.log( changedGUI._closed );\n\t * } );\n\t */\n\tonOpenClose( callback ) {\n\t\tthis._onOpenClose = callback;\n\t\treturn this;\n\t}\n\n\t_callOnOpenClose( changedGUI ) {\n\t\tif ( this.parent ) {\n\t\t\tthis.parent._callOnOpenClose( changedGUI );\n\t\t}\n\n\t\tif ( this._onOpenClose !== undefined ) {\n\t\t\tthis._onOpenClose.call( this, changedGUI );\n\t\t}\n\t}\n\n\t/**\n\t * Destroys all DOM elements and event listeners associated with this GUI.\n\t */\n\tdestroy() {\n\n\t\tif ( this.parent ) {\n\t\t\tthis.parent.children.splice( this.parent.children.indexOf( this ), 1 );\n\t\t\tthis.parent.folders.splice( this.parent.folders.indexOf( this ), 1 );\n\t\t}\n\n\t\tif ( this.domElement.parentElement ) {\n\t\t\tthis.domElement.parentElement.removeChild( this.domElement );\n\t\t}\n\n\t\tArray.from( this.children ).forEach( c => c.destroy() );\n\n\t}\n\n\t/**\n\t * Returns an array of controllers contained by this GUI and its descendents.\n\t * @returns {Controller[]}\n\t */\n\tcontrollersRecursive() {\n\t\tlet controllers = Array.from( this.controllers );\n\t\tthis.folders.forEach( f => {\n\t\t\tcontrollers = controllers.concat( f.controllersRecursive() );\n\t\t} );\n\t\treturn controllers;\n\t}\n\n\t/**\n\t * Returns an array of folders contained by this GUI and its descendents.\n\t * @returns {GUI[]}\n\t */\n\tfoldersRecursive() {\n\t\tlet folders = Array.from( this.folders );\n\t\tthis.folders.forEach( f => {\n\t\t\tfolders = folders.concat( f.foldersRecursive() );\n\t\t} );\n\t\treturn folders;\n\t}\n\n}\n\nexport default GUI;\nexport { BooleanController, ColorController, Controller, FunctionController, GUI, NumberController, OptionController, StringController };\n", "import type GUI from 'lil-gui';\nimport type { Coordinate, Label, MapData, Marker } from '../../';\nimport { normalizeColor } from './utils';\nimport type { MapView } from '../../map-view';\nimport { createIsInViewHandler } from './interaction-control';\nimport { LABEL_STATE_TYPE, MARKER_STATE_TYPE } from '../../states';\n\nexport function createLabelControls(labelFolder: GUI, _mapData: MapData, mapView: MapView) {\n\tconst state = {\n\t\tlabels: {} as { [id: string]: Label },\n\t\tall() {\n\t\t\tconst labels = mapView.Labels.__EXPERIMENTAL__all();\n\t\t\tlabels.forEach(l => {\n\t\t\t\tthis.labels[l.id] = l;\n\t\t\t});\n\t\t\trenderLabels();\n\t\t},\n\t\tremoveAllLabels() {\n\t\t\tconst removed = mapView.Labels.removeAll();\n\t\t\tremoved.forEach(l => {\n\t\t\t\tdelete this.labels[l.id];\n\t\t\t});\n\t\t\trenderLabels();\n\t\t},\n\t};\n\tconst { addLabel, destroy } = createAddControl(labelFolder, mapView);\n\n\tlabelFolder.add(state, 'all');\n\tlabelFolder.add(state, 'removeAllLabels');\n\tlet labelsListFolder = labelFolder.addFolder('Label List');\n\n\tlabelFolder.close();\n\n\tconst labelGuiMap = new Map<string, GUI>();\n\tconst { rerender: renderLabels } = createLabelControls();\n\tfunction createLabelControls() {\n\t\tfunction remove(label: Label) {\n\t\t\tdelete state.labels[label.id];\n\t\t\tlabelGuiMap.get(label.id)?.destroy();\n\t\t}\n\t\tfunction add(label: Label) {\n\t\t\tconst control = addLabelControlToFolder(mapView, label, labelsListFolder, {\n\t\t\t\tonRemove: l => {\n\t\t\t\t\tremove(l as Label);\n\t\t\t\t},\n\t\t\t});\n\t\t\tif (!control) return;\n\t\t\tconst { labelItemFolder } = control;\n\t\t\tlabelGuiMap.set(label.id, labelItemFolder);\n\t\t}\n\t\tfunction rerender() {\n\t\t\tlabelsListFolder.destroy();\n\t\t\tlabelsListFolder = labelFolder.addFolder('Label');\n\t\t\tfor (const k in state.labels) {\n\t\t\t\tconst item = state.labels[k];\n\t\t\t\tadd(item);\n\t\t\t}\n\t\t}\n\n\t\treturn { rerender, add, remove };\n\t}\n\tlabelFolder.domElement.classList.add('list-items');\n\tlet lastLabelControl: GUI;\n\tmapView.on('click', ({ labels, coordinate }) => {\n\t\tif (labelFolder._closed) return;\n\t\tif (labels?.[0]) {\n\t\t\tlastLabelControl?.close();\n\t\t\tconst control = labelGuiMap.get(labels[0].id);\n\t\t\tlabelFolder.open();\n\t\t\tif (!control) return;\n\t\t\tcontrol?.open();\n\t\t\tcontrol?.domElement.scrollIntoView({\n\t\t\t\tblock: 'start',\n\t\t\t});\n\t\t\tcontrol?.domElement.focus();\n\t\t\tlastLabelControl = control;\n\t\t} else {\n\t\t\taddLabel(coordinate);\n\t\t}\n\t});\n\n\tfunction populatelabels(labels: Label[]) {\n\t\tfor (const label of labels) {\n\t\t\tstate.labels[label.id] = label;\n\t\t}\n\t\trenderLabels();\n\t}\n\n\treturn {\n\t\tpopulatelabels,\n\t\tdestroy() {\n\t\t\tdestroy();\n\t\t},\n\t};\n}\n\nfunction handleMarkerState(\n\tmapView: MapView,\n\tentity: Marker,\n\titemFolder: GUI,\n\tstate: any,\n\tonRemove?: (removed: Marker) => void,\n) {\n\tconst { interactive, enabled, rank, anchor, dynamicResize, zIndex, contentHTML, lowPriorityPin } = state;\n\tif (interactive == null || enabled == null) throw new Error('incomplete marker state');\n\n\tconst uiState = {\n\t\tinteractive,\n\t\tenabled,\n\t\trank: rank || 'medium',\n\t\tanchor: Array.isArray(anchor) ? anchor.join(', ') : anchor || 'center',\n\t\tdynamicResize: dynamicResize || false,\n\t\tzIndex: zIndex || 0,\n\t\tcontentHTML: contentHTML || '',\n\t\tlowPriorityPin: {\n\t\t\tenabled: lowPriorityPin?.enabled ?? true,\n\t\t\tsize: lowPriorityPin?.size ?? 8,\n\t\t\tcolor: normalizeColor(lowPriorityPin?.color ?? '#666'),\n\t\t},\n\t\tremove() {\n\t\t\tmapView.Markers.remove(entity);\n\t\t\tonRemove?.(entity);\n\t\t\titemFolder.destroy();\n\t\t},\n\t\tisInView: createIsInViewHandler(mapView, entity.id),\n\t};\n\n\titemFolder.onChange(_ => {\n\t\tconst updates: any = {\n\t\t\tinteractive: uiState.interactive,\n\t\t\tenabled: uiState.enabled,\n\t\t\trank: uiState.rank as any,\n\t\t\tdynamicResize: uiState.dynamicResize,\n\t\t\tcontentHTML: uiState.contentHTML,\n\t\t\tlowPriorityPin: {\n\t\t\t\tenabled: uiState.lowPriorityPin.enabled,\n\t\t\t\tsize: uiState.lowPriorityPin.size,\n\t\t\t\tcolor: uiState.lowPriorityPin.color,\n\t\t\t},\n\t\t};\n\n\t\t// Only include zIndex if rank is 'always-visible'\n\t\tif (uiState.rank === 'always-visible') {\n\t\t\tupdates.zIndex = uiState.zIndex;\n\t\t}\n\n\t\tmapView.updateState(entity, updates);\n\t});\n\n\t// Basic properties\n\titemFolder.add(uiState, 'interactive');\n\titemFolder.add(uiState, 'enabled');\n\titemFolder.add(uiState, 'rank', ['medium', 'high', 'always-visible', 'initial']).name('rank');\n\titemFolder.add(uiState, 'anchor').name('anchor (read-only)').disable();\n\titemFolder.add(uiState, 'dynamicResize').name('dynamic resize');\n\n\t// Only show zIndex control when rank is 'always-visible'\n\tif (uiState.rank === 'always-visible') {\n\t\titemFolder.add(uiState, 'zIndex', 0, 1000, 1).name('z-index');\n\t}\n\n\t// Content\n\titemFolder.add(uiState, 'contentHTML').name('content HTML');\n\n\t// Low priority pin\n\tconst lowPriorityFolder = itemFolder.addFolder('Low Priority Pin');\n\tlowPriorityFolder.add(uiState.lowPriorityPin, 'enabled');\n\tlowPriorityFolder.add(uiState.lowPriorityPin, 'size', 1, 20, 1);\n\tlowPriorityFolder.addColor(uiState.lowPriorityPin, 'color');\n\tlowPriorityFolder.close();\n\n\t// Actions\n\titemFolder.add(uiState, 'isInView');\n\titemFolder.add(uiState, 'remove');\n}\n\nfunction handleLabelState(\n\tmapView: MapView,\n\tentity: Label,\n\titemFolder: GUI,\n\tstate: any,\n\tonRemove?: (removed: Label) => void,\n) {\n\tconst { appearance, interactive } = state;\n\tif (!appearance || appearance.margin == null || interactive == null) throw new Error('incomplte label state');\n\n\tconst uiState = {\n\t\ttext: entity.text,\n\t\tinteractive,\n\t\tappearance: {\n\t\t\t...appearance,\n\t\t\tmargin: appearance.margin || 0,\n\t\t\tpinColor: appearance.pinColor ? normalizeColor(appearance.pinColor) : 'black',\n\t\t\ttextColor: appearance.textColor ? normalizeColor(appearance.textColor) : 'black',\n\t\t},\n\t\tremove() {\n\t\t\tmapView.Labels.remove(entity);\n\t\t\tonRemove?.(entity);\n\t\t\titemFolder.destroy();\n\t\t},\n\t\tisInView: createIsInViewHandler(mapView, entity.id),\n\t};\n\n\titemFolder.onChange(_ => {\n\t\tmapView.updateState(entity, {\n\t\t\tappearance: uiState.appearance as any,\n\t\t\tinteractive: uiState.interactive,\n\t\t});\n\t});\n\n\titemFolder.add(uiState.appearance, 'margin', 0, 20).name('margin');\n\titemFolder.add(uiState, 'text');\n\titemFolder.add(uiState, 'interactive');\n\titemFolder.addColor(uiState.appearance, 'pinColor').name('pin color');\n\titemFolder.addColor(uiState.appearance, 'pinOutlineColor').name('pin outline color');\n\titemFolder.addColor(uiState.appearance, 'textColor').name('text color');\n\titemFolder.addColor(uiState.appearance, 'textOutlineColor').name('text outline color');\n\titemFolder.add(uiState, 'isInView');\n\titemFolder.add(uiState, 'remove');\n}\n\nexport function addLabelControlToFolder(\n\tmapView: MapView,\n\tentity: Label | Marker,\n\tparent: GUI,\n\t{ onRemove }: { onRemove?: (removed: Label | Marker) => void } = {},\n) {\n\tconst state = mapView.getState(entity);\n\n\tif (!state) throw new Error(`error getting state for entity: ${entity.id}`);\n\n\tconst folderName =\n\t\tstate.type === LABEL_STATE_TYPE\n\t\t\t? (entity as Label).text?.substring(0, 12) || 'Label'\n\t\t\t: `Marker ${entity.id.toString().substring(0, 8)}`;\n\n\tconst itemFolder = parent.addFolder(folderName);\n\titemFolder.close();\n\n\tif (state.type === LABEL_STATE_TYPE) {\n\t\thandleLabelState(mapView, entity as Label, itemFolder, state, onRemove as any);\n\t} else if (state.type === MARKER_STATE_TYPE) {\n\t\thandleMarkerState(mapView, entity as Marker, itemFolder, state, onRemove as any);\n\t} else {\n\t\tthrow new Error(`unsupported entity type: ${(state as any).type}`);\n\t}\n\n\treturn {\n\t\tlabelItemFolder: itemFolder,\n\t\tdestroy() {\n\t\t\titemFolder.destroy();\n\t\t},\n\t};\n}\n\nfunction createAddControl(labelFolder: GUI, mapView: MapView) {\n\tconst addFolder = labelFolder.addFolder('Add');\n\tconst state = {\n\t\tonClick: false,\n\t\tmargin: 6,\n\t\ttext: 'New Label!',\n\t\tinteractive: true,\n\t\tmarginForegroundColor: normalizeColor('skyblue'),\n\t\tmarginBackgroundColor: normalizeColor('coral'),\n\t\ttextForegroundColor: normalizeColor('slategray'),\n\t\ttextBackgroundColor: normalizeColor('white'),\n\t};\n\n\taddFolder.add(state, 'onClick');\n\taddFolder.add(state, 'margin');\n\taddFolder.add(state, 'interactive');\n\taddFolder.add(state, 'text');\n\n\treturn {\n\t\tdestroy() {\n\t\t\taddFolder.destroy();\n\t\t},\n\t\taddLabel(coordinate: Coordinate) {\n\t\t\tif (addFolder._closed || !state.onClick) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst label = mapView.Labels.add(coordinate, state.text, {\n\t\t\t\tappearance: {\n\t\t\t\t\tmargin: state.margin,\n\t\t\t\t\tpinColor: state.marginForegroundColor,\n\t\t\t\t\tpinOutlineColor: state.marginBackgroundColor,\n\t\t\t\t\ttextColor: state.textForegroundColor,\n\t\t\t\t\ttextOutlineColor: state.textBackgroundColor,\n\t\t\t\t},\n\t\t\t\tinteractive: state.interactive,\n\t\t\t});\n\n\t\t\treturn label;\n\t\t},\n\t};\n}\n", "import { Color } from 'three';\nimport type { MapView } from '../../map-view';\nimport type GUI from 'lil-gui';\n\nexport const normalizeColor = (() => {\n\tconst color = new Color();\n\n\treturn function normalize(c: string) {\n\t\tcolor.set(c);\n\n\t\treturn `#${color.getHexString()}`;\n\t};\n})();\n\nexport function noop() {}\n\nexport function runAll(fns: (() => void)[]) {\n\tlet fn: () => void;\n\tfor (fn of fns) {\n\t\tfn();\n\t}\n}\n\nexport function updateCurrentUrlParamsWithNamespace(params: Record<string, any>, namespace: string) {\n\tconst currentUrl = window.location.href;\n\tconst urlObj = new URL(currentUrl);\n\tconst searchParams = new URLSearchParams(urlObj.search);\n\n\t// Append namespace to each parameter key\n\tfor (const key in params) {\n\t\tif (params.hasOwnProperty(key)) {\n\t\t\tconst namespacedKey = `${namespace}.${key}`;\n\t\t\tsearchParams.set(namespacedKey, params[key]);\n\t\t}\n\t}\n\n\turlObj.search = searchParams.toString();\n\thistory.pushState({ path: urlObj.toString() }, '', urlObj.toString());\n}\n\nexport function getUrlParamsWithNamespace(namespace: string, state?: Record<string, any>) {\n\tconst searchParams = new URLSearchParams(window.location.search);\n\tconst params: any = {};\n\n\t// Extract only parameters that start with the specified namespace\n\tfor (const [key, value] of searchParams) {\n\t\tif (key.startsWith(`${namespace}.`)) {\n\t\t\tconst actualKey = key.slice(namespace.length + 1);\n\t\t\tif (value === 'true' || value === 'false') {\n\t\t\t\tparams[actualKey] = value === 'true';\n\t\t\t} else if (typeof state?.[actualKey] === 'number') {\n\t\t\t\tparams[actualKey] = Number(value);\n\t\t\t} else {\n\t\t\t\tparams[actualKey] = value;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn { namespace, params };\n}\n\nconst propToRender = ['interactive'];\n/**\n * Should support rendering and controlling most state props\n */\nexport function renderByProp(\n\tmapView: MapView,\n\tstate: { id: string; __type: string; isInView?: () => void; [key: string]: any },\n\tparentGui: GUI,\n) {\n\tconst entityIdentity = { id: state.id, __type: state.__type } as any;\n\tconst itemFolder = parentGui.addFolder(`${state.type}-${state.id}`);\n\tfor (const prop in state) {\n\t\tif (prop === 'visible') {\n\t\t\titemFolder.add(state, prop).onChange(v => {\n\t\t\t\tmapView.updateState(entityIdentity, { [prop]: v });\n\t\t\t});\n\t\t}\n\t\tif (prop === 'color' || prop === 'hoverColor') {\n\t\t\tstate[prop] = normalizeColor(state[prop]);\n\t\t\titemFolder.addColor(state, prop).onChange(c => {\n\t\t\t\tmapView.updateState(entityIdentity, { [prop]: c });\n\t\t\t});\n\t\t\tcontinue;\n\t\t}\n\t\tif (prop === 'height') {\n\t\t\titemFolder.add(state, prop, 0, 20, 1).onChange(c => {\n\t\t\t\tmapView.updateState(entityIdentity, { [prop as any]: c });\n\t\t\t});\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (prop === 'texture' && state['texture']) {\n\t\t\tconst tFolder = itemFolder.addFolder('Texture - side');\n\t\t\ttFolder.add(state, 'texture')?.onChange(c => {\n\t\t\t\tmapView.updateState(entityIdentity, {\n\t\t\t\t\ttexture: {\n\t\t\t\t\t\turl: c,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t});\n\t\t\tcontinue;\n\t\t}\n\t\tif (prop === 'topTexture' && state['topTexture']) {\n\t\t\tconst tFolderTop = itemFolder.addFolder('Texture - top');\n\t\t\ttFolderTop.add(state, 'topTexture')?.onChange(c => {\n\t\t\t\tmapView.updateState(entityIdentity, {\n\t\t\t\t\ttopTexture: {\n\t\t\t\t\t\turl: c,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tcontinue;\n\t\t}\n\t\tif (prop === 'opacity') {\n\t\t\titemFolder.add(state, prop, 0, 1, 0.1).onChange(c => {\n\t\t\t\tmapView.updateState(entityIdentity, { [prop as any]: c });\n\t\t\t});\n\t\t\tcontinue;\n\t\t}\n\t\tif (prop === 'altitude') {\n\t\t\titemFolder.add(state, prop, 0, 100, 1).onChange(c => {\n\t\t\t\tmapView.updateState(entityIdentity, { [prop as any]: c });\n\t\t\t});\n\t\t\tcontinue;\n\t\t}\n\t\tif (propToRender.includes(prop)) {\n\t\t\titemFolder.add(state, prop).onChange(v => {\n\t\t\t\tmapView.updateState(entityIdentity, { [prop]: v });\n\t\t\t});\n\t\t}\n\t}\n\tif (state.isInView) {\n\t\titemFolder.add(state, 'isInView').listen().disable();\n\t\titemFolder.add(state, 'isInViewCheck');\n\t}\n\n\treturn {\n\t\tcleanup() {\n\t\t\titemFolder.destroy();\n\t\t},\n\t};\n}\n", "import type GUI from 'lil-gui';\nimport { addLabelControlToFolder } from './labels-control';\nimport { normalizeColor, renderByProp } from './utils';\nimport type { MapView } from '../../map-view';\nimport { highlightControl } from './highlight';\nimport { PubSub } from '@packages/internal/common';\nimport type { TClickPayload, TEvents } from '../../events';\nimport { EnterpriseLocation, Space } from '../../map-data-objects';\nimport { createSearchControl } from './search-control';\nimport type MapData from '../../map-data';\n\nexport function createInteractionControls(mapView: MapView, mapData: MapData, parent: GUI) {\n\tparent.domElement.id = 'interactionPanel';\n\n\tlet cleanup: (() => void)[] = [];\n\n\tconst { pubsub: searchPubsub } = createSearchControl(mapView, mapData, parent);\n\tsearchPubsub.on('highlight', item => {\n\t\tif (item) {\n\t\t\tcleanup.forEach(fn => fn());\n\t\t\tcleanup = [];\n\t\t\tconst space = item instanceof EnterpriseLocation ? item.spaces[0] : (item as any);\n\t\t\tmapView.Camera.focusOn(item);\n\t\t\tif (space && !Space.is(space)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcleanup.push(highlightControl.highlightCard(mapView, space, { focus: true }));\n\t\t} else {\n\t\t\tcleanup.forEach(fn => fn());\n\t\t\tcleanup = [];\n\t\t}\n\t});\n\n\tconst clickFolder = parent.addFolder('Click \uD83D\uDC47').close();\n\tconst { sub: clickSub } = createClickControls(mapView, clickFolder);\n\tclickSub.on('click', payload => {\n\t\tcleanup.forEach(fn => fn());\n\t\tcleanup = [];\n\t\tif (payload.spaces?.[0]) {\n\t\t\tcleanup = [highlightControl.highlightCard(mapView, payload.spaces[0])];\n\t\t}\n\t});\n\n\tconst hoverFolder = parent.addFolder('Hover \uD83D\uDE81').close();\n\tconst { sub: hoverSub } = createHoverControls(mapView, hoverFolder);\n\tlet hoverCleanup: (() => void) | undefined;\n\thoverSub.on('hover', payload => {\n\t\tif (payload.spaces?.[0]) {\n\t\t\thoverCleanup?.();\n\t\t\tif (cleanup.length === 0) {\n\t\t\t\thoverCleanup = highlightControl.highlightCard(mapView, payload.spaces[0]);\n\t\t\t}\n\t\t} else {\n\t\t\thoverCleanup?.();\n\t\t\thoverCleanup = undefined;\n\t\t}\n\t});\n}\n\nfunction createClickControls(mapView: MapView, clickFolder: GUI) {\n\tconst sub = new PubSub<{ click: TClickPayload }>();\n\tconst state = { position: '', hoverColor: normalizeColor(mapView.getHoverColor()!) };\n\tconst positionControl = clickFolder.add(state, 'position').disable();\n\n\tconst cleanups: (() => void)[] = [];\n\tfunction reset() {\n\t\tcleanups.forEach(fn => fn());\n\t\tcleanups.length = 0;\n\t}\n\n\tlet intervalId: NodeJS.Timeout = 0 as any;\n\tmapView.on('click', payload => {\n\t\tconst { labels, coordinate } = payload;\n\t\treset();\n\t\tsub.publish('click', payload);\n\t\tclearInterval(intervalId);\n\t\tpositionControl.load(JSON.stringify([coordinate.longitude, coordinate.latitude]));\n\t\tconst entity2D = labels?.[0];\n\t\tif (entity2D != null) {\n\t\t\tconst labelControl = addLabelControlToFolder(mapView, entity2D, clickFolder);\n\t\t\tif (!labelControl) return;\n\t\t\tcleanups.push(labelControl.destroy);\n\t\t\tlabelControl.labelItemFolder.openAnimated();\n\t\t}\n\t\tconst geometryDataObject = payload.spaces?.[0] ?? payload.objects?.[0];\n\t\tif (geometryDataObject) {\n\t\t\tconst state = {\n\t\t\t\t...geometryDataObject,\n\t\t\t\t...mapView.getState(geometryDataObject),\n\t\t\t\tisInView: false,\n\t\t\t\tisInViewCheck: createIsInViewHandler(mapView, geometryDataObject.id),\n\t\t\t};\n\t\t\tconst { cleanup } = renderByProp(mapView, state as any, clickFolder);\n\t\t\tintervalId = setInterval(() => {\n\t\t\t\tstate.isInView = mapView.isInView(entity2D || geometryDataObject);\n\t\t\t}, 500);\n\n\t\t\tcleanups.push(cleanup);\n\t\t}\n\t});\n\n\treturn { sub };\n}\n\nfunction createHoverControls(mapView: MapView, parent: GUI) {\n\tconst sub = new PubSub<{ hover: TEvents['hover'] }>();\n\tmapView.setHoverColor('#1f3a7a');\n\tconst state = {\n\t\tposition: '',\n\t\thoverColor: normalizeColor(mapView.getHoverColor()!),\n\t\tintersected: '',\n\t\ttype: '',\n\t\tid: '',\n\t};\n\tconst positionControl = parent.add(state, 'position').disable();\n\t// const intersectedControl = parent.add(state, 'intersected').disable();\n\tparent.add(state, 'id').disable().listen();\n\tparent.add(state, 'type').disable().listen();\n\tparent.addColor(state, 'hoverColor').onChange(c => {\n\t\tmapView.setHoverColor(c);\n\t});\n\tconst cleanups: (() => void)[] = [];\n\tfunction reset() {\n\t\tcleanups.forEach(fn => fn());\n\t\tcleanups.length = 0;\n\t}\n\n\tmapView.on('hover', hoverState => {\n\t\tconst { coordinate, spaces, objects, markers, labels } = hoverState;\n\t\treset();\n\t\tsub.publish('hover', hoverState);\n\t\tpositionControl.load(JSON.stringify([coordinate.longitude, coordinate.latitude]));\n\t\tconst entity = spaces?.[0] ?? objects?.[0] ?? markers?.[0] ?? labels?.[0];\n\t\tif (!entity) return;\n\t\tconst s = mapView.getState(entity);\n\t\tif (!s) return;\n\t\tstate.type = s.type;\n\t\tstate.id = entity.id;\n\t});\n\n\treturn { sub };\n}\n\nexport function createIsInViewHandler(mapView: MapView, id: string) {\n\treturn function isInView() {\n\t\t// eslint-disable-next-line\n\t\tconsole.log('isInView', mapView.isInView(id));\n\t};\n}\n", "import GUI from 'lil-gui';\nimport type { Places } from '../../map-data-objects';\nimport { EnterpriseCategory, EnterpriseLocation, Space } from '../../map-data-objects';\nimport type { MapView } from '../../map-view';\nimport type { Marker } from '../../map-view-objects';\nimport type { TFocusOnOptions } from '../../types';\nimport { renderByProp } from './utils';\n\nfunction createHighlightControl() {\n\tconst lastMarkers: Marker[] = [];\n\n\tfunction getHighlightTarget(mapView: MapView, item: EnterpriseLocation | EnterpriseCategory | Places) {\n\t\tconst mapData = Object.values(mapView.getMapData())[0];\n\n\t\tlet target = item;\n\t\tif (target && Space.is(target)) {\n\t\t\tconst foundLocation = mapData.getByType('enterprise-location')?.find(l => l.spaces.some(s => s.id === target.id));\n\t\t\tif (foundLocation) {\n\t\t\t\ttarget = foundLocation;\n\t\t\t}\n\t\t}\n\n\t\treturn target;\n\t}\n\n\tasync function focusOn(mapView: MapView, target: EnterpriseLocation | EnterpriseCategory | Places) {\n\t\tif (target instanceof EnterpriseCategory) {\n\t\t\treturn mapView.Camera.focusOn(\n\t\t\t\ttarget.locations.flatMap(l => l.spaces),\n\t\t\t\tfocusOnOptions,\n\t\t\t);\n\t\t} else if (target instanceof EnterpriseLocation) {\n\t\t\treturn mapView.Camera.focusOn(target.spaces, focusOnOptions);\n\t\t} else {\n\t\t\treturn mapView.Camera.focusOn(target, focusOnOptions);\n\t\t}\n\t}\n\tfunction highlightCard(\n\t\tmapView: MapView,\n\t\titem: EnterpriseLocation | EnterpriseCategory | Places,\n\t\t{ focus = false }: { focus?: boolean } = {},\n\t) {\n\t\tif (!(window as any).enableHighlightCard) {\n\t\t\treturn () => {};\n\t\t}\n\t\tconst target = getHighlightTarget(mapView, item);\n\t\tconst card = document.createElement('div');\n\t\tcard.style.cssText = `\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 20px;\n\t\t\t\tleft: 20px;\n\t\t\t\tbackground-color: rgba(30, 30, 30, 0.95);\n\t\t\t\tbox-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n\t\t\t\tborder-radius: 12px;\n\t\t\t\tpadding: 24px;\n\t\t\t\tmax-width: 320px;\n\t\t\t\tz-index: 1000;\n\t\t\t\tfont-family: 'Arial', sans-serif;\n\t\t\t\ttransition: all 0.3s ease;\n\t\t\t\tcolor: #e0e0e0;\n\t\t\t`;\n\n\t\tif ('name' in target) {\n\t\t\tconst title = document.createElement('h3');\n\t\t\ttitle.textContent = target.name;\n\t\t\ttitle.style.cssText = `\n\t\t\t\tmargin: 0 0 16px;\n\t\t\t\tfont-size: 22px;\n\t\t\t\tfont-weight: 600;\n\t\t\t\tcolor: #ffffff;\n\t\t\t\tletter-spacing: -0.5px;\n\t\t\t`;\n\t\t\tcard.appendChild(title);\n\t\t}\n\n\t\tif (target instanceof EnterpriseLocation) {\n\t\t\tif (target.description) {\n\t\t\t\tconst description = document.createElement('p');\n\t\t\t\tdescription.textContent = target.description;\n\t\t\t\tdescription.style.cssText = `\n\t\t\t\t\tmargin: 0 0 16px;\n\t\t\t\t\tfont-size: 14px;\n\t\t\t\t\tcolor: #b0b0b0;\n\t\t\t\t\tline-height: 1.5;\n\t\t\t\t`;\n\t\t\t\tcard.appendChild(description);\n\t\t\t}\n\n\t\t\tif (target.tags && target.tags.length > 0) {\n\t\t\t\tconst tagsContainer = document.createElement('div');\n\t\t\t\ttagsContainer.style.cssText = `\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-wrap: nowrap;\n\t\t\t\t\tgap: 8px;\n\t\t\t\t\tmargin-bottom: 16px;\n\t\t\t\t\toverflow-x: hidden;\n\t\t\t\t\tmax-height: 30px; /* Adjust this value based on your font size and padding */\n\t\t\t\t`;\n\t\t\t\ttarget.tags.forEach(tag => {\n\t\t\t\t\tconst tagElement = document.createElement('span');\n\t\t\t\t\ttagElement.textContent = tag;\n\t\t\t\t\ttagElement.style.cssText = `\n\t\t\t\t\t\tbackground-color: #3a3a3a;\n\t\t\t\t\t\tcolor: #e0e0e0;\n\t\t\t\t\t\tpadding: 6px 12px;\n\t\t\t\t\t\tborder-radius: 16px;\n\t\t\t\t\t\tfont-size: 12px;\n\t\t\t\t\t\tfont-weight: 500;\n\t\t\t\t\t\ttext-transform: uppercase;\n\t\t\t\t\t\twhite-space: nowrap;\n\t\t\t\t\t`;\n\t\t\t\t\ttagsContainer.appendChild(tagElement);\n\t\t\t\t});\n\t\t\t\tcard.appendChild(tagsContainer);\n\t\t\t}\n\t\t}\n\n\t\tlet controls;\n\t\tif (!(item instanceof EnterpriseCategory)) {\n\t\t\tconst gui = new GUI({ autoPlace: false });\n\t\t\tgui.domElement.style.cssText = `\n\t\t\t\t\tposition: relative;\n\t\t\t\t\toverflow-y: auto;\n\t\t\t\t\tmargin-top: 16px;\n\t\t\t\t\tborder-top: 1px solid #444;\n\t\t\t\t\tpadding-top: 16px;\n\t\t\t\t`;\n\t\t\tconst state = mapView.getState(item as any);\n\t\t\tif (state) {\n\t\t\t\trenderByProp(mapView, { id: item.id, ...(state as any) }, gui);\n\t\t\t\tcard.appendChild(gui.domElement);\n\t\t\t}\n\t\t\tcontrols = gui;\n\t\t}\n\n\t\tdocument.body.appendChild(card);\n\t\tif (focus) {\n\t\t\tfocusOn(mapView, target);\n\t\t}\n\n\t\treturn () => {\n\t\t\tcard.style.opacity = '0';\n\t\t\tcard.style.transform = 'translateY(-10px)';\n\t\t\tsetTimeout(() => card.remove(), 300);\n\t\t\tcontrols?.destroy();\n\t\t};\n\t}\n\n\treturn {\n\t\thighlightCard,\n\t\thighlight: (\n\t\t\tmapView: MapView,\n\t\t\titem: EnterpriseLocation | EnterpriseCategory | Places,\n\t\t\t{ focus = true }: { focus?: boolean } = {},\n\t\t) => {\n\t\t\tif (lastMarkers.length > 0) {\n\t\t\t\tlastMarkers.forEach(marker => mapView.Markers.remove(marker));\n\t\t\t}\n\n\t\t\tconst target = getHighlightTarget(mapView, item);\n\n\t\t\tif (target instanceof EnterpriseLocation) {\n\t\t\t\tif (focus) mapView.Camera.focusOn(target.spaces, focusOnOptions);\n\t\t\t\tlastMarkers.push(\n\t\t\t\t\t...target.spaces.map(space =>\n\t\t\t\t\t\tmapView.Markers.add(\n\t\t\t\t\t\t\tspace,\n\t\t\t\t\t\t\t`<div style=\"padding: 15px; background-color: #ffffff; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 250px; position: relative;\">\n\t\t\t\t\t\t\t<h3 style=\"margin: 0 0 10px; color: #333; font-size: 16px; font-weight: 600;\">${target.name}</h3>\n\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\ttarget.description\n\t\t\t\t\t\t\t\t\t? `<p style=\"margin: 0 0 10px; color: #666; font-size: 14px; font-weight: 400;\">${target.description}</p>`\n\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\ttarget.tags\n\t\t\t\t\t\t\t\t\t? target.tags\n\t\t\t\t\t\t\t\t\t\t\t.map(\n\t\t\t\t\t\t\t\t\t\t\t\ttag =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t`<span style=\"display: inline-block; padding: 3px 8px; background-color: #e0f2f1; color: #00796b; border-radius: 12px; font-size: 12px;\">${tag}</span>`,\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t.join(' ')\n\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t<div style=\"position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent; border-top: 10px solid #ffffff;\"></div>\n\t\t\t\t\t\t</div>`,\n\t\t\t\t\t\t\t{ rank: 'always-visible', placement: 'top' },\n\t\t\t\t\t\t),\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t} else if (target instanceof EnterpriseCategory) {\n\t\t\t\tif (focus) {\n\t\t\t\t\tmapView.Camera.focusOn(\n\t\t\t\t\t\ttarget.locations.flatMap(l => l.spaces),\n\t\t\t\t\t\tfocusOnOptions,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tconst locationMarkers = new Map();\n\t\t\t\tconst coordinateNames = new Set();\n\t\t\t\ttarget.locations.forEach(location => {\n\t\t\t\t\tif (!locationMarkers.has(location.name)) {\n\t\t\t\t\t\tlocation.spaces.forEach(space => {\n\t\t\t\t\t\t\tlastMarkers.push(\n\t\t\t\t\t\t\t\tmapView.Markers.add(\n\t\t\t\t\t\t\t\t\tspace,\n\t\t\t\t\t\t\t\t\t`<div style=\"padding: 12px; background-color: rgba(0, 153, 51, 0.95); border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.3); transform: translateY(-4px); transition: all 0.3s ease;\">\n\t\t\t\t\t\t\t\t\t<span style=\"font-weight: 600; color: #FFFFFF; font-size: 16px; text-shadow: 1px 1px 2px rgba(0,0,0,0.2);\">${location.name}</span>\n\t\t\t\t\t\t\t\t</div>`,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\trank: 'always-visible',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tlocationMarkers.set(location.name, true);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\ttarget.locations.forEach(location => {\n\t\t\t\t\tlocation.coordinates.forEach(space => {\n\t\t\t\t\t\tconst key = `${space.latitude},${space.longitude}`;\n\t\t\t\t\t\tif (!coordinateNames.has(key) && !locationMarkers.has(location.name)) {\n\t\t\t\t\t\t\tconst marker = mapView.Markers.add(\n\t\t\t\t\t\t\t\tspace,\n\t\t\t\t\t\t\t\t`<div style=\"padding: 10px; background-color: rgba(51, 102, 204, 0.9); border-radius: 6px; box-shadow: 0 3px 6px rgba(0,0,0,0.2);\">\n\t\t\t\t\t\t\t\t<span style=\"font-weight: 500; color: #FFFFFF; font-size: 16px;\">${location.name}</span>\n\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t<span style=\"color: #FFFFFF; font-size: 12px; font-weight: 400;\">Node</span>\n\t\t\t\t\t\t\t</div>`,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\trank: 'always-visible',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcoordinateNames.add(key);\n\t\t\t\t\t\t\tlastMarkers.push(marker);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// mapView.Camera.focusOn(target, focusOnOptions);\n\t\t\t}\n\n\t\t\treturn () => {\n\t\t\t\tlastMarkers.forEach(marker => mapView.Markers.remove(marker));\n\t\t\t};\n\t\t},\n\t};\n}\n\nconst focusOnOptions: TFocusOnOptions = {\n\tduration: 300,\n\teasing: 'ease-in-out',\n};\n\nexport const highlightControl = createHighlightControl();\n", "import type GUI from 'lil-gui';\nimport type MapData from '../../map-data';\nimport { type MapView } from '../../map-view';\nimport { type SearchResult } from '../../';\nimport { PubSub } from '@packages/internal/common';\nimport type { EnterpriseLocation, Places } from '../../map-data-objects';\nconst state = {\n\tsearch: '',\n\tresults: undefined as SearchResult | undefined,\n\toptions: {\n\t\tplaces: {\n\t\t\tfields: {\n\t\t\t\tname: true,\n\t\t\t\tdescription: true,\n\t\t\t\tlink: true,\n\t\t\t\tcategory: true,\n\t\t\t},\n\t\t\tlimit: 5,\n\t\t},\n\t\tlocations: {\n\t\t\tfields: {\n\t\t\t\tname: true,\n\t\t\t\ttag: true,\n\t\t\t\tdescription: true,\n\t\t\t},\n\t\t\tlimit: 5,\n\t\t},\n\t\tcategories: {\n\t\t\tfields: {\n\t\t\t\tname: true,\n\t\t\t},\n\t\t\tlimit: 5,\n\t\t},\n\t},\n};\n\nfunction createAdvancedSettings(parent: GUI) {\n\tparent.add(state.options.places.fields, 'name').name('Places: Name');\n\tparent.add(state.options.places.fields, 'description').name('Places: Description');\n\tparent.add(state.options.places.fields, 'link').name('Places: Link');\n\tparent.add(state.options.places.fields, 'category').name('Places: Category');\n\tparent.add(state.options.places, 'limit');\n\tparent.add(state.options.locations.fields, 'name').name('Locations: Name');\n\tparent.add(state.options.locations.fields, 'tag').name('Locations: Tag');\n\tparent.add(state.options.locations.fields, 'description').name('Locations: Description');\n\tparent.add(state.options.places, 'limit');\n\tparent.add(state.options.categories.fields, 'name').name('Categories: Name');\n}\n\nexport function createSearchControl(mapView: MapView, mapData: MapData, parent: GUI) {\n\tconst pubsub = new PubSub<{ highlight: EnterpriseLocation | Places }>();\n\tconst searchPanel = parent.addFolder('Search');\n\tsearchPanel.open();\n\n\tconst control = searchPanel.add(state, 'search').onChange(async v => {\n\t\tconst results = await mapData.Search.query(v, state.options);\n\t\tif (!results) return;\n\t\tstate.results = results;\n\t\trenderSearchQuery(results, pubsub);\n\t});\n\n\tconst resultsContainer = document.createElement('div');\n\tresultsContainer.style.marginLeft = '10px';\n\tcontrol.domElement.parentElement?.appendChild(resultsContainer);\n\tconst { renderSearch: renderSearchQuery, close } = mount(mapView, mapData, resultsContainer, (control as any).$input);\n\n\tconst advancedSettingsPanel = searchPanel.addFolder('Advanced');\n\tadvancedSettingsPanel.close();\n\tcreateAdvancedSettings(advancedSettingsPanel);\n\n\t// Add event listener for Ctrl+K to focus on the search input\n\tdocument.addEventListener('keydown', (e: KeyboardEvent) => {\n\t\tif ((e.metaKey || e.ctrlKey) && e.key === 'k') {\n\t\t\te.preventDefault();\n\t\t\tif (searchPanel._closed) searchPanel.open();\n\t\t\t((control as any).$input as HTMLInputElement).focus();\n\t\t} else if (e.key === 'Escape') {\n\t\t\tclose();\n\t\t\tpubsub.publish('highlight', undefined);\n\t\t}\n\t});\n\n\treturn {\n\t\tpubsub,\n\t};\n}\n\nfunction mount(mapView: MapView, mapData: MapData, containerEl: HTMLDivElement, input: HTMLInputElement) {\n\tlet suggestTimeout: NodeJS.Timeout;\n\tlet dropdownControl: ReturnType<typeof createCustomDropdown>;\n\n\tinput.addEventListener('input', async (event: Event) => {\n\t\tif (\n\t\t\tevent instanceof InputEvent &&\n\t\t\t(event.inputType === 'insertText' || event.inputType === 'insertCompositionText')\n\t\t) {\n\t\t\tclearTimeout(suggestTimeout);\n\t\t\tsuggestTimeout = setTimeout(async () => {\n\t\t\t\tconst suggestions = await mapData.Search.suggest(input.value);\n\t\t\t\tif (suggestions && suggestions.length > 0) renderSuggestion(suggestions[0]?.suggestion);\n\t\t\t}, 100);\n\t\t}\n\t});\n\n\tfunction renderSuggestion(suggestion: string | undefined) {\n\t\tif (!suggestion) {\n\t\t\tinput.placeholder = '';\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst inputValue = input.value;\n\t\tinput.value = suggestion;\n\t\tinput.setSelectionRange(inputValue.length, suggestion.length);\n\t}\n\n\treturn {\n\t\trenderSearch(results: SearchResult, pubsub: PubSub<{ highlight: EnterpriseLocation | Places }>) {\n\t\t\tif (\n\t\t\t\tresults.places.length === 0 &&\n\t\t\t\tresults.enterpriseCategories?.length === 0 &&\n\t\t\t\tresults.enterpriseLocations?.length === 0\n\t\t\t) {\n\t\t\t\tcontainerEl.textContent = 'No results found.';\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdropdownControl = createCustomDropdown(containerEl, results, mapView, pubsub);\n\t\t},\n\t\tclose() {\n\t\t\tdropdownControl.destroy();\n\t\t},\n\t};\n}\n\nfunction createCustomDropdown(\n\tcontainerEl: HTMLDivElement,\n\tresults: SearchResult,\n\t_mapView: MapView,\n\tpubsub: PubSub<{ highlight: EnterpriseLocation | Places }>,\n) {\n\tcontainerEl.innerHTML = ''; // Clear previous results\n\n\tconst dropdownContainer = document.createElement('div');\n\tObject.assign(dropdownContainer.style, styles.dropdownContainer);\n\n\tconst optionsList = document.createElement('ul');\n\toptionsList.className = 'options-list';\n\tObject.assign(optionsList.style, styles.optionsList);\n\toptionsList.style.display = 'block'; // Always display the options list\n\n\tconst options: HTMLLIElement[] = [];\n\n\tconst addSection = (\n\t\ttitle: string,\n\t\titems?: SearchResult['enterpriseLocations'] | SearchResult['enterpriseCategories'] | SearchResult['places'],\n\t) => {\n\t\tif (items && items.length > 0) {\n\t\t\tconst sectionHeader = document.createElement('li');\n\t\t\tsectionHeader.textContent = title;\n\t\t\tObject.assign(sectionHeader.style, styles.sectionHeader);\n\t\t\toptionsList.appendChild(sectionHeader);\n\n\t\t\titems.forEach((item, i) => {\n\t\t\t\tconst option = document.createElement('li');\n\t\t\t\toption.textContent = `${'name' in item.item ? item.item.name : ''} (${item.type})`;\n\t\t\t\tObject.assign(option.style, styles.option);\n\t\t\t\toption.tabIndex = 0;\n\n\t\t\t\toption.addEventListener('focus', () => {\n\t\t\t\t\thighlightOption(options.indexOf(option));\n\t\t\t\t});\n\n\t\t\t\toption.addEventListener('mouseover', () => {\n\t\t\t\t\toption.style.backgroundColor = '#f0f0f0';\n\t\t\t\t});\n\n\t\t\t\toption.addEventListener('mouseout', () => {\n\t\t\t\t\toption.style.backgroundColor = '';\n\t\t\t\t});\n\n\t\t\t\toption.addEventListener('click', () => {\n\t\t\t\t\t// Add your navigation logic here\n\t\t\t\t});\n\n\t\t\t\toption.setAttribute('data-type', title);\n\t\t\t\toption.setAttribute('data-index', i.toString());\n\n\t\t\t\toptionsList.appendChild(option);\n\t\t\t\toptions.push(option);\n\t\t\t});\n\t\t}\n\t};\n\n\taddSection('enterpriseLocations', results.enterpriseLocations);\n\taddSection('enterpriseCategories', results.enterpriseCategories);\n\taddSection('Places', results.places);\n\n\tdropdownContainer.appendChild(optionsList);\n\tcontainerEl.appendChild(dropdownContainer);\n\n\tlet highlightUndo: (() => void)[] = [];\n\tconst highlightOption = (index: number) => {\n\t\thighlightUndo.forEach(undo => undo());\n\t\thighlightUndo = [];\n\t\toptions.forEach((opt, i) => {\n\t\t\tif (i === index) {\n\t\t\t\topt.style.backgroundColor = '#e0e0e0';\n\t\t\t} else {\n\t\t\t\topt.style.backgroundColor = '';\n\t\t\t}\n\t\t});\n\t\tconst option = options[index];\n\t\tconst type = option.getAttribute('data-type');\n\t\tconst i = parseInt(option.getAttribute('data-index') || '0', 10);\n\t\tif (!type) return;\n\t\tconst { item } = results[type.toLowerCase()][i];\n\n\t\tpubsub.publish('highlight', item);\n\t};\n\n\t// Add click event listener to the document to handle clicks outside the dropdown\n\tconst handleClickOutside = (event: MouseEvent) => {\n\t\tif (!dropdownContainer.contains(event.target as Node) && event.target !== containerEl) {\n\t\t\tdestroy();\n\t\t}\n\t};\n\n\tdocument.addEventListener('click', handleClickOutside);\n\n\tconst destroy = () => {\n\t\tcontainerEl.innerHTML = ''; // Clear previous results\n\t\tdocument.removeEventListener('click', handleClickOutside);\n\t};\n\n\treturn {\n\t\tdestroy() {\n\t\t\tcontainerEl.innerHTML = ''; // Clear previous results\n\t\t\tpubsub.publish('highlight', undefined);\n\t\t},\n\t};\n}\n\nvar styles: Readonly<any> = {\n\tdropdownContainer: {\n\t\tposition: 'absolute',\n\t\tcolor: '#202020',\n\t},\n\toptionsList: {\n\t\tdisplay: 'block',\n\t\tzIndex: '1002',\n\t\tposition: 'relative',\n\t\tmaxHeight: '200px',\n\t\toverflowY: 'auto',\n\t\tborder: '1px solid #ccc',\n\t\tbackgroundColor: '#fff',\n\t\tlistStyleType: 'none',\n\t\tmargin: '0',\n\t\tpadding: '0',\n\t},\n\tsectionHeader: {\n\t\tfontWeight: 'bold',\n\t\tpadding: '5px',\n\t\tbackgroundColor: '#f0f0f0',\n\t},\n\toption: {\n\t\tpadding: '5px',\n\t\tcursor: 'pointer',\n\t},\n};\n", ".mappedin-js-inspector .list-items {\n  max-height: 600px;\n  overflow-y: scroll;\n  scroll-behavior: smooth;\n}\n.mappedin-js-inspector .children:focus {\n  border: 1px solid blue;\n}\n.mappedin-js-inspector #interactionPanel {\n  position: absolute;\n  right: 0;\n}\n.mappedin-js-inspector #mainPanel {\n  position: absolute;\n  left: 0px;\n}\n.mappedin-js-inspector .title {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiL2hvbWUvamVua2lucy93b3Jrc3BhY2UvZGV2LXJlbGF0aW9uL1dlYlNESyBWNiBBbHBoYSAtIEJ1aWxkIHdpdGggR2l0aHViIFBhY2thZ2VzL3Nka3MvbWFwcGVkaW4tanMvc3JjL2FwaS1nZW9qc29uL2luc3BlY3RvciIsInNvdXJjZXMiOlsic3R5bGUuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQztFQUNDO0VBQ0E7RUFDQTs7QUFFRDtFQUNDOztBQUVEO0VBQ0M7RUFDQTs7QUFFRDtFQUNDO0VBQ0E7O0FBRUQ7RUFDQztFQUNBO0VBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyIubWFwcGVkaW4tanMtaW5zcGVjdG9yIHtcblx0Lmxpc3QtaXRlbXMge1xuXHRcdG1heC1oZWlnaHQ6IDYwMHB4O1xuXHRcdG92ZXJmbG93LXk6IHNjcm9sbDtcblx0XHRzY3JvbGwtYmVoYXZpb3I6IHNtb290aDtcblx0fVxuXHQuY2hpbGRyZW46Zm9jdXMge1xuXHRcdGJvcmRlcjogMXB4IHNvbGlkIGJsdWU7XG5cdH1cblx0I2ludGVyYWN0aW9uUGFuZWwge1xuXHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0XHRyaWdodDogMDtcblx0fVxuXHQjbWFpblBhbmVsIHtcblx0XHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdFx0bGVmdDogMHB4O1xuXHR9XG5cdC50aXRsZSB7XG5cdFx0d2hpdGUtc3BhY2U6IG5vd3JhcDtcblx0XHRvdmVyZmxvdzogaGlkZGVuO1xuXHRcdHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xuXHR9XG59XG4iXX0= */", "import type GUI from 'lil-gui';\nimport { getUrlParamsWithNamespace, runAll, updateCurrentUrlParamsWithNamespace } from './utils';\nimport type { CameraTransform, TClickPayload, InsetPadding } from '../../';\nimport { Coordinate } from '../../';\nimport type { MapView } from '../../map-view';\nimport type { InspectorState } from './inspector';\n\nconst CAMERA_UI = 'camera-ui';\nexport function createCameraControls(parent: GUI, mapView: MapView, options?: InspectorState['camera']) {\n\tconst cameraControl = parent.addFolder('Camera \uD83D\uDCF7').onOpenClose(v => {\n\t\tupdateCurrentUrlParamsWithNamespace({ opened: !v._closed }, CAMERA_UI);\n\t});\n\tconst { params: cameraUiState } = getUrlParamsWithNamespace(CAMERA_UI);\n\tif (!cameraUiState.opened) {\n\t\tcameraControl.close();\n\t}\n\tconst initialCameraCenter = mapView.Camera.center.toJSON();\n\n\tconst el = document.createElement('div');\n\tObject.assign(el.style, {\n\t\tdisplay: 'none',\n\t\tposition: 'absolute',\n\t\tleft: 0 + 'px',\n\t\tzIndex: 999,\n\t\ttop: 0 + 'px',\n\t\tbottom: 0 + 'px',\n\t\tright: 0 + 'px',\n\t\tbackgroundColor: 'aqua',\n\t\tpointerEvents: 'none',\n\t\topacity: 0.5,\n\t});\n\tmapView.container.appendChild(el);\n\n\t// Use container dimensions instead of window dimensions\n\tconst getContainerDimensions = () => mapView.getDimensions();\n\n\tconst [top, right, bottom, left] = options?.padding ?? [\n\t\tmapView.Camera.screenOffsets.top,\n\t\tmapView.Camera.screenOffsets.right,\n\t\tmapView.Camera.screenOffsets.bottom,\n\t\tmapView.Camera.screenOffsets.left,\n\t];\n\tconst state = {\n\t\tcenter_lat: initialCameraCenter.latitude,\n\t\tcenter_lon: initialCameraCenter.longitude,\n\t\tzoomLevel: mapView.Camera.zoomLevel,\n\t\tpitch: mapView.Camera.pitch,\n\t\tbearing: mapView.Camera.bearing,\n\t\tminZoomLevel: mapView.Camera.minZoomLevel,\n\t\tmaxZoomLevel: mapView.Camera.maxZoomLevel,\n\t\tinset_type: options?.padding ? ('pixel' as InsetPadding['type']) : mapView.Camera.screenOffsets.type,\n\t\tinset_top: top,\n\t\tinset_left: left,\n\t\tinset_right: right,\n\t\tinset_bottom: bottom,\n\t\tanimateOnLoad: true,\n\t\tpersist: () => {\n\t\t\tupdateCurrentUrlParamsWithNamespace((cameraControl.save() as any).controllers, 'camera');\n\t\t\tnavigator.clipboard.writeText(window.location.href);\n\t\t},\n\t\tvisualizeInset: Boolean(top || right || bottom || left),\n\t\t'Focus on click': options?.focusOnClick ?? true,\n\t\t'Focus on current floor': () => {\n\t\t\tmapView.Camera.focusOn([mapView.currentFloor], {\n\t\t\t\tscreenOffsets: {\n\t\t\t\t\ttop: 20,\n\t\t\t\t\tleft: 20,\n\t\t\t\t\tright: 20,\n\t\t\t\t\tbottom: 20,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t};\n\n\tfunction updateInsetVisualizer() {\n\t\tstate.inset_type = mapView.Camera.screenOffsets.type;\n\t\tstate.inset_left = mapView.Camera.screenOffsets.left;\n\t\tstate.inset_top = mapView.Camera.screenOffsets.top;\n\t\tstate.inset_right = mapView.Camera.screenOffsets.right;\n\t\tstate.inset_bottom = mapView.Camera.screenOffsets.bottom;\n\n\t\t// Use container dimensions for visualization\n\t\tconst { width: w, height: h } = getContainerDimensions();\n\n\t\tif (state.inset_type === 'portion') {\n\t\t\tObject.assign(el.style, {\n\t\t\t\tleft: state.inset_left * w + 'px',\n\t\t\t\ttop: state.inset_top * h + 'px',\n\t\t\t\tbottom: state.inset_bottom * h + 'px',\n\t\t\t\tright: state.inset_right * w + 'px',\n\t\t\t});\n\t\t} else {\n\t\t\tObject.assign(el.style, {\n\t\t\t\tleft: state.inset_left + 'px',\n\t\t\t\ttop: state.inset_top + 'px',\n\t\t\t\tbottom: state.inset_bottom + 'px',\n\t\t\t\tright: state.inset_right + 'px',\n\t\t\t});\n\t\t}\n\t}\n\n\tcameraControl.add(state, 'center_lat').listen().disable();\n\tcameraControl.add(state, 'center_lon').listen().disable();\n\tcameraControl.add(state, 'zoomLevel', 16, 22, 0.5).listen().disable();\n\tcameraControl.add(state, 'pitch').listen().disable();\n\tcameraControl.add(state, 'bearing').listen().disable();\n\tcameraControl.add(state, 'minZoomLevel', 5, 22, 0.5).onChange(v => {\n\t\tmapView.Camera.setMinZoomLevel(v);\n\t});\n\tcameraControl.add(state, 'maxZoomLevel', 10, 22, 0.5).onChange(v => {\n\t\tmapView.Camera.setMaxZoomLevel(v);\n\t});\n\n\tcameraControl.add(state, 'animateOnLoad');\n\n\tcameraControl.add(state, 'visualizeInset').onChange(visualizeInsetUpdated);\n\tvisualizeInsetUpdated(state.visualizeInset);\n\n\t// Store references to the inset controls so we can update their ranges\n\tlet insetTopControl: any;\n\tlet insetBottomControl: any;\n\tlet insetLeftControl: any;\n\tlet insetRightControl: any;\n\n\t// Function to update inset control ranges based on type\n\tfunction updateInsetControlRanges() {\n\t\tconst { width: w, height: h } = getContainerDimensions();\n\n\t\t// Get current type before switching\n\t\tconst previousType = mapView.Camera.screenOffsets.type;\n\t\tconst currentType = state.inset_type;\n\n\t\t// Convert values when switching between types\n\t\tif (previousType !== currentType) {\n\t\t\tif (currentType === 'portion' && previousType === 'pixel') {\n\t\t\t\t// Convert pixel values to portion (0-1)\n\t\t\t\tstate.inset_top = w > 0 ? Math.min(state.inset_top / h, 1) : 0;\n\t\t\t\tstate.inset_bottom = w > 0 ? Math.min(state.inset_bottom / h, 1) : 0;\n\t\t\t\tstate.inset_left = h > 0 ? Math.min(state.inset_left / w, 1) : 0;\n\t\t\t\tstate.inset_right = h > 0 ? Math.min(state.inset_right / w, 1) : 0;\n\t\t\t} else if (currentType === 'pixel' && previousType === 'portion') {\n\t\t\t\t// Convert portion values to pixel\n\t\t\t\tstate.inset_top = Math.round(state.inset_top * h);\n\t\t\t\tstate.inset_bottom = Math.round(state.inset_bottom * h);\n\t\t\t\tstate.inset_left = Math.round(state.inset_left * w);\n\t\t\t\tstate.inset_right = Math.round(state.inset_right * w);\n\t\t\t}\n\t\t}\n\n\t\t// Remove existing controls\n\t\tif (insetTopControl) insetTopControl.destroy();\n\t\tif (insetBottomControl) insetBottomControl.destroy();\n\t\tif (insetLeftControl) insetLeftControl.destroy();\n\t\tif (insetRightControl) insetRightControl.destroy();\n\n\t\tif (state.inset_type === 'portion') {\n\t\t\t// For portion type, range should be 0-1 (0-100%)\n\t\t\tinsetTopControl = cameraControl.add(state, 'inset_top', 0, 1, 0.01).onChange(updateInset);\n\t\t\tinsetBottomControl = cameraControl.add(state, 'inset_bottom', 0, 1, 0.01).onChange(updateInset);\n\t\t\tinsetLeftControl = cameraControl.add(state, 'inset_left', 0, 1, 0.01).onChange(updateInset);\n\t\t\tinsetRightControl = cameraControl.add(state, 'inset_right', 0, 1, 0.01).onChange(updateInset);\n\t\t} else {\n\t\t\t// For pixel type, range should be 0 to container dimensions\n\t\t\tinsetTopControl = cameraControl.add(state, 'inset_top', 0, h, 1).onChange(updateInset);\n\t\t\tinsetBottomControl = cameraControl.add(state, 'inset_bottom', 0, h, 1).onChange(updateInset);\n\t\t\tinsetLeftControl = cameraControl.add(state, 'inset_left', 0, w, 1).onChange(updateInset);\n\t\t\tinsetRightControl = cameraControl.add(state, 'inset_right', 0, w, 1).onChange(updateInset);\n\t\t}\n\t}\n\n\t// Add type control and update ranges when type changes\n\tcameraControl.add(state, 'inset_type', ['pixel', 'portion']).onChange(() => {\n\t\tupdateInsetControlRanges();\n\t\tupdateInset();\n\t});\n\n\t// Initialize inset controls with correct ranges\n\tupdateInsetControlRanges();\n\n\tconst handler = createHandler(mapView);\n\tcameraControl.add(state, 'Focus on click').onChange(v => {\n\t\tif (v) {\n\t\t\tmapView.on('click', handler);\n\t\t} else {\n\t\t\tmapView.off('click', handler);\n\t\t}\n\t});\n\tif (state['Focus on click']) mapView.on('click', handler);\n\tcameraControl.add(state, 'persist');\n\tcameraControl.add(state, 'Focus on current floor');\n\n\tconst onCameraChanged = (v: CameraTransform) => {\n\t\tif (cameraControl._closed) return;\n\t\tstate.center_lat = v.center.latitude;\n\t\tstate.center_lon = v.center.longitude;\n\t\tstate.zoomLevel = v.zoomLevel;\n\t\tstate.bearing = v.bearing;\n\t\tstate.pitch = v.pitch;\n\t};\n\n\tmapView.on('camera-change', onCameraChanged);\n\n\t// handle loading camera state from url\n\tconst { params } = getUrlParamsWithNamespace('camera', state);\n\tif (Object.keys(params).length > 0) {\n\t\tconst paramState: typeof state = params;\n\t\tmapView.Camera.setScreenOffsets({\n\t\t\ttop: paramState.inset_top,\n\t\t\tleft: paramState.inset_left,\n\t\t\tright: paramState.inset_right,\n\t\t\tbottom: paramState.inset_bottom,\n\t\t\ttype: paramState.inset_type,\n\t\t});\n\t\tconst target = {\n\t\t\tpitch: paramState.pitch,\n\t\t\tcenter: new Coordinate(paramState.center_lat, paramState.center_lon),\n\t\t\tbearing: paramState.bearing,\n\t\t\tzoomLevel: paramState.zoomLevel,\n\t\t};\n\t\tif (paramState.animateOnLoad) {\n\t\t\tmapView.Camera.animateTo(target);\n\t\t} else {\n\t\t\tmapView.Camera.set(target);\n\t\t}\n\t\tcameraControl.load({ controllers: paramState, folders: {} });\n\t\tupdateInsetVisualizer();\n\t}\n\n\tconst cleanups = [\n\t\t() => {\n\t\t\tmapView.off('camera-change', onCameraChanged);\n\t\t},\n\t];\n\n\tfunction updateInset() {\n\t\tmapView.Camera.setScreenOffsets({\n\t\t\ttop: state.inset_top,\n\t\t\tleft: state.inset_left,\n\t\t\tright: state.inset_right,\n\t\t\tbottom: state.inset_bottom,\n\t\t\ttype: state.inset_type,\n\t\t});\n\t\tupdateInsetVisualizer();\n\t}\n\n\tif (state.inset_top || state.inset_right || state.inset_bottom || state.inset_left) {\n\t\t// a bit of #trust\n\t\tupdateInset();\n\t}\n\n\tfunction visualizeInsetUpdated(v: boolean) {\n\t\tupdateInsetVisualizer();\n\t\tif (v) {\n\t\t\tel.style.display = 'block';\n\t\t} else {\n\t\t\tel.style.display = 'none';\n\t\t}\n\t}\n\n\treturn () => ({\n\t\tdestroy() {\n\t\t\tcameraControl.destroy();\n\t\t\trunAll(cleanups);\n\t\t},\n\t});\n}\n\nfunction createHandler(mapView: MapView) {\n\treturn function handler(payload: TClickPayload) {\n\t\tconst { spaces, objects } = payload;\n\t\tconst item = spaces?.[0] ?? objects?.[0];\n\t\tif (item) mapView.Camera.focusOn(item);\n\t};\n}\n", "import type GUI from 'lil-gui';\nimport type { Coordinate, Marker, MapData } from '../../';\nimport type { MapView } from '../../map-view';\nimport { addLabelControlToFolder } from './labels-control';\n\nexport function createMarkerControls(markerFolder: GUI, _mapData: MapData, mapView: MapView) {\n\tconst state = {\n\t\tmarkers: {} as { [id: string]: Marker },\n\t\tremoveAllMarkers() {\n\t\t\tconst removed = mapView.Markers.removeAll();\n\t\t\tremoved.forEach(l => {\n\t\t\t\tdelete this.markers[l.id];\n\t\t\t});\n\t\t\trenderMarkers();\n\t\t},\n\t};\n\tconst { addMarker, destroy } = createAddControl(markerFolder, mapView);\n\n\tmarkerFolder.add(state, 'removeAllMarkers');\n\tlet markersListFolder = markerFolder.addFolder('Marker List');\n\n\tmarkerFolder.close();\n\n\tconst markerGuiMap = new Map<string, GUI>();\n\tconst { rerender: renderMarkers } = createMarkerControls();\n\tfunction createMarkerControls() {\n\t\tfunction remove(marker: Marker) {\n\t\t\tdelete state.markers[marker.id];\n\t\t\tmarkerGuiMap.get(marker.id)?.destroy();\n\t\t}\n\t\tfunction add(marker: Marker) {\n\t\t\tconst control = addLabelControlToFolder(mapView, marker, markersListFolder, {\n\t\t\t\tonRemove: l => {\n\t\t\t\t\tremove(l as Marker);\n\t\t\t\t},\n\t\t\t});\n\t\t\tif (!control) return;\n\t\t\tconst { labelItemFolder } = control;\n\t\t\tmarkerGuiMap.set(marker.id, labelItemFolder);\n\t\t}\n\t\tfunction rerender() {\n\t\t\tmarkersListFolder.destroy();\n\t\t\tmarkersListFolder = markerFolder.addFolder('marker');\n\t\t\tfor (const k in state.markers) {\n\t\t\t\tconst item = state.markers[k];\n\t\t\t\tadd(item);\n\t\t\t}\n\t\t}\n\n\t\treturn { rerender, add, remove };\n\t}\n\tmarkerFolder.domElement.classList.add('list-items');\n\tlet lastMarkerControl: GUI;\n\tmapView.on('click', ({ markers, coordinate }) => {\n\t\tif (markerFolder._closed) return;\n\t\tif (markers?.[0]) {\n\t\t\tlastMarkerControl?.close();\n\t\t\tconst control = markerGuiMap.get(markers[0].id);\n\t\t\tmarkerFolder.open();\n\t\t\tif (!control) return;\n\t\t\tcontrol?.open();\n\t\t\tcontrol?.domElement.scrollIntoView({\n\t\t\t\tblock: 'start',\n\t\t\t});\n\t\t\tcontrol?.domElement.focus();\n\t\t\tlastMarkerControl = control;\n\t\t} else {\n\t\t\taddMarker(coordinate);\n\t\t}\n\t});\n\n\tfunction populateMarkers(markers: Marker[]) {\n\t\tfor (const marker of markers) {\n\t\t\tstate.markers[marker.id] = marker;\n\t\t}\n\t\trenderMarkers();\n\t}\n\n\treturn {\n\t\tpopulateMarkers,\n\t\tdestroy() {\n\t\t\tdestroy();\n\t\t},\n\t};\n}\n\n// This function is now replaced by the enhanced addLabelControlToFolder in labels-control.ts\n// export function addMarkerControlToFolder is deprecated\n\nfunction createAddControl(markerFolder: GUI, mapView: MapView) {\n\tconst addFolder = markerFolder.addFolder('Add');\n\tconst state = {\n\t\tonClick: false,\n\t\tinteractive: true,\n\t\trank: 'medium' as 'medium' | 'high' | 'always-visible' | 'initial',\n\t\tanchor: 'center' as any,\n\t\tdynamicResize: false,\n\t\tenabled: true,\n\t\tzIndex: 0,\n\t\tlowPriorityPin: {\n\t\t\tenabled: true,\n\t\t\tsize: 8,\n\t\t\tcolor: '#666',\n\t\t},\n\t\tcontentHTML:\n\t\t\t'<div style=\"padding: 8px; background: white; border: 2px solid #333; border-radius: 4px;\">New Marker</div>',\n\t};\n\n\taddFolder.add(state, 'onClick');\n\taddFolder.add(state, 'interactive');\n\taddFolder.add(state, 'enabled');\n\taddFolder.add(state, 'rank', ['medium', 'high', 'always-visible', 'initial']).name('rank');\n\taddFolder\n\t\t.add(state, 'anchor', [\n\t\t\t'center',\n\t\t\t'top',\n\t\t\t'bottom',\n\t\t\t'left',\n\t\t\t'right',\n\t\t\t'top-left',\n\t\t\t'top-right',\n\t\t\t'bottom-left',\n\t\t\t'bottom-right',\n\t\t])\n\t\t.name('anchor');\n\taddFolder.add(state, 'dynamicResize').name('dynamic resize');\n\taddFolder.add(state, 'zIndex', 0, 1000, 1).name('z-index (always-visible only)');\n\taddFolder.add(state, 'contentHTML').name('content HTML');\n\n\t// Low priority pin controls\n\tconst lowPriorityFolder = addFolder.addFolder('Low Priority Pin');\n\tlowPriorityFolder.add(state.lowPriorityPin, 'enabled');\n\tlowPriorityFolder.add(state.lowPriorityPin, 'size', 1, 20, 1);\n\tlowPriorityFolder.addColor(state.lowPriorityPin, 'color');\n\tlowPriorityFolder.close();\n\n\treturn {\n\t\tdestroy() {\n\t\t\taddFolder.destroy();\n\t\t},\n\t\taddMarker(coordinate: Coordinate) {\n\t\t\tif (addFolder._closed || !state.onClick) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst options: any = {\n\t\t\t\tinteractive: state.interactive,\n\t\t\t\tenabled: state.enabled,\n\t\t\t\trank: state.rank,\n\t\t\t\tanchor: state.anchor,\n\t\t\t\tdynamicResize: state.dynamicResize,\n\t\t\t\tlowPriorityPin: {\n\t\t\t\t\tenabled: state.lowPriorityPin.enabled,\n\t\t\t\t\tsize: state.lowPriorityPin.size,\n\t\t\t\t\tcolor: state.lowPriorityPin.color,\n\t\t\t\t},\n\t\t\t};\n\n\t\t\t// Only include zIndex if rank is 'always-visible'\n\t\t\tif (state.rank === 'always-visible') {\n\t\t\t\toptions.zIndex = state.zIndex;\n\t\t\t}\n\n\t\t\tconst marker = mapView.Markers.add(coordinate, state.contentHTML, options);\n\n\t\t\treturn marker;\n\t\t},\n\t};\n}\n", "import type GUI from 'lil-gui';\nimport type { MapView } from '../../map-view';\nimport { WALLS } from '../../types';\n\nexport function createGeometryControl(parent: GUI, mapView: MapView) {\n\tconst panel = parent.addFolder('Walls').close();\n\tconst state = { visible: true, topColor: '#b1fa87', color: '#e8e8e8', texture: { url: '' }, topTexture: { url: '' } };\n\tpanel.add(state, 'visible').onChange(v => {\n\t\tmapView.updateState(WALLS.Exterior, {\n\t\t\tvisible: v,\n\t\t});\n\t});\n\tpanel.addColor(state, 'topColor').onChange(v => {\n\t\tmapView.updateState(WALLS.Exterior, {\n\t\t\ttopColor: v,\n\t\t});\n\t});\n\n\tpanel.addColor(state, 'color').onChange(v => {\n\t\tmapView.updateState(WALLS.Exterior, {\n\t\t\tcolor: v,\n\t\t});\n\t});\n\n\tconst tFolder = panel.addFolder('Texture - side');\n\ttFolder.add(state.texture, 'url').onFinishChange(c => {\n\t\tmapView.updateState(WALLS.Exterior, {\n\t\t\ttexture: {\n\t\t\t\turl: c,\n\t\t\t},\n\t\t});\n\t});\n\tconst tFolderTop = panel.addFolder('Texture - top');\n\ttFolderTop.add(state.topTexture, 'url').onFinishChange(c => {\n\t\tmapView.updateState(WALLS.Exterior, {\n\t\t\ttopTexture: {\n\t\t\t\turl: c,\n\t\t\t},\n\t\t});\n\t});\n\n\tmapView.updateState(WALLS.Exterior, {\n\t\ttopColor: state.topColor,\n\t});\n\n\tmapView.updateState(WALLS.Exterior, {\n\t\tcolor: state.color,\n\t});\n}\n", "/* eslint-disable no-console */\nimport type GUI from 'lil-gui';\nimport type { MapData, MapView } from '../../../src';\n\nexport function createMiscControl(panel: GUI, _mapView: MapView, mapData: MapData) {\n\tpanel.close();\n\tconst state = {\n\t\tlanguage: mapData.currentLanguage?.code ?? 'en',\n\t};\n\tconst venue = mapData.getByType('enterprise-venue');\n\tpanel\n\t\t.add(\n\t\t\tstate,\n\t\t\t'language',\n\t\t\tvenue?.languages.map(v => v.code),\n\t\t)\n\t\t.onChange(v => {\n\t\t\tmapData.changeLanguage(v);\n\t\t});\n}\n", "import type GUI from 'lil-gui';\nimport type { MapData, MapView, Debug } from '../..';\nexport function createDebugControl(parent: GUI, mapView: MapView, _mapData: MapData) {\n\tconst folder = parent.addFolder('Debug');\n\tfolder.close();\n\tconst debugInitialState = mapView.Debug.state;\n\tconst state = {\n\t\tshowPolygonLabelTextAreaMesh: debugInitialState.showPolygonLabelTextAreaMesh,\n\t\tshowCollisionBoxes: debugInitialState.showCollisionBoxes,\n\t\tshowEnvMap: debugInitialState.showEnvMap,\n\t};\n\n\tfolder\n\t\t.add(state, 'showPolygonLabelTextAreaMesh')\n\t\t.onChange((v: boolean) => {\n\t\t\tmapView.Debug.update({ showPolygonLabelTextAreaMesh: v });\n\t\t})\n\t\t.name('Show Flat Label Text Area Mesh');\n\n\tfolder\n\t\t.add(state, 'showCollisionBoxes')\n\t\t.onChange((v: boolean) => {\n\t\t\tmapView.Debug.update({ showCollisionBoxes: v });\n\t\t})\n\t\t.name('Show Collision Boxes');\n\n\tfolder\n\t\t.add(state, 'showEnvMap')\n\t\t.onChange((v: boolean) => {\n\t\t\tmapView.Debug.update({ showEnvMap: v });\n\t\t})\n\t\t.name('Show Environment Map');\n\n\tmapView.Debug.update(state as Debug['state']);\n}\n", "import type GUI from 'lil-gui';\nimport type { MapData, MapView } from '../..';\n\nexport function createText3DControl(parent: GUI, mapView: MapView, _mapData: MapData) {\n\tconst folder = parent.addFolder('Text3D').close();\n\tconst state = {\n\t\tall: () => {\n\t\t\tmapView.Text3D.labelAll();\n\t\t},\n\t\tremoveAll: () => {\n\t\t\tmapView.Text3D.removeAll();\n\t\t},\n\t};\n\n\tfolder.add(state, 'all').name('Show All');\n\tfolder.add(state, 'removeAll').name('Remove All');\n}\n"],
  "mappings": "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",
  "names": ["init_define_process", "Controller", "_Controller", "parent", "object", "property", "className", "elementType", "e", "name", "callback", "enabled", "disabled", "show", "options", "controller", "min", "max", "step", "decimals", "listen", "curValue", "value", "BooleanController", "normalizeColorString", "string", "match", "result", "STRING", "v", "INT", "ARRAY", "target", "rgbScale", "int", "r", "g", "b", "OBJECT", "FORMATS", "getColorFormat", "format", "ColorController", "tryParse", "newValue", "FunctionController", "NumberController", "stepExplicit", "explicit", "percent", "onInput", "increment", "delta", "onKeyDown", "onWheel", "testingForVerticalDrag", "initClientX", "initClientY", "prevClientY", "initValue", "dragDelta", "DRAG_THRESH", "onMouseDown", "onMouseMove", "onMouseUp", "dx", "dy", "onFocus", "onBlur", "map", "a", "c", "d", "setValueFromX", "clientX", "rect", "mouseDown", "mouseMove", "mouseUp", "testingForScroll", "prevClientX", "beginTouchDrag", "onTouchStart", "onTouchMove", "onTouchEnd", "callOnFinishChange", "WHEEL_DEBOUNCE_TIME", "wheelFinishChangeTimeout", "active", "axis", "deltaX", "deltaY", "mult", "root", "OptionController", "$option", "index", "StringController", "stylesheet", "_injectStyles", "cssContent", "injected", "before", "stylesInjected", "GUI", "_GUI", "autoPlace", "container", "width", "title", "closeFolders", "injectStyles", "touchStyles", "$1", "initialValue", "folder", "obj", "recursive", "f", "open", "closed", "initialHeight", "onTransitionEnd", "targetHeight", "changedGUI", "controllers", "folders", "lil_gui_esm_default", "normalizeColor", "color", "Color", "runAll", "fns", "fn", "updateCurrentUrlParamsWithNamespace", "params", "namespace", "currentUrl", "urlObj", "searchParams", "key", "namespacedKey", "getUrlParamsWithNamespace", "state", "actualKey", "propToRender", "renderByProp", "mapView", "parentGui", "entityIdentity", "itemFolder", "prop", "createHighlightControl", "lastMarkers", "getHighlightTarget", "item", "mapData", "space_default", "foundLocation", "l", "s", "focusOn", "category_default", "focusOnOptions", "location_default", "highlightCard", "focus", "card", "description", "tagsContainer", "tag", "tagElement", "controls", "gui", "marker", "space", "locationMarkers", "coordinateNames", "location", "highlightControl", "createAdvancedSettings", "createSearchControl", "pubsub", "PubSub", "searchPanel", "control", "results", "renderSearchQuery", "resultsContainer", "close", "mount", "advancedSettingsPanel", "containerEl", "input", "suggestTimeout", "dropdownControl", "event", "suggestions", "renderSuggestion", "suggestion", "inputValue", "createCustomDropdown", "_mapView", "dropdownContainer", "styles", "optionsList", "addSection", "items", "sectionHeader", "i", "option", "highlightOption", "highlightUndo", "undo", "opt", "type", "handleClickOutside", "destroy", "createInteractionControls", "cleanup", "searchPubsub", "clickFolder", "clickSub", "createClickControls", "payload", "hoverFolder", "hoverSub", "createHoverControls", "hoverCleanup", "sub", "positionControl", "cleanups", "reset", "intervalId", "labels", "coordinate", "entity2D", "labelControl", "addLabelControlToFolder", "geometryDataObject", "createIsInViewHandler", "hoverState", "spaces", "objects", "markers", "entity", "id", "createLabelControls", "labelFolder", "_mapData", "renderLabels", "addLabel", "createAddControl", "labelsListFolder", "labelGuiMap", "remove", "label", "add", "labelItemFolder", "rerender", "k", "lastLabelControl", "populatelabels", "handleMarkerState", "onRemove", "interactive", "rank", "anchor", "dynamicResize", "zIndex", "contentHTML", "lowPriorityPin", "uiState", "_", "updates", "lowPriorityFolder", "handleLabelState", "appearance", "folderName", "LABEL_STATE_TYPE", "MARKER_STATE_TYPE", "addFolder", "style_default", "CAMERA_UI", "createCameraControls", "cameraControl", "cameraUiState", "initialCameraCenter", "el", "getContainerDimensions", "top", "right", "bottom", "left", "updateInsetVisualizer", "w", "h", "visualizeInsetUpdated", "insetTopControl", "insetBottomControl", "insetLeftControl", "insetRightControl", "updateInsetControlRanges", "previousType", "currentType", "updateInset", "handler", "createHandler", "onCameraChanged", "paramState", "coordinate_default", "createMarkerControls", "markerFolder", "renderMarkers", "addMarker", "markersListFolder", "markerGuiMap", "lastMarkerControl", "populateMarkers", "createGeometryControl", "panel", "createMiscControl", "venue", "createDebugControl", "debugInitialState", "createText3DControl", "createUi", "injectCss", "levelsFolder", "sceneFolder", "miscFolder", "levels", "acc", "floor", "levelsControl", "update", "o", "STYLE_EL_ID", "style", "Inspector", "mv", "api", "__publicField", "data", "mountSceneGraphVisualizer"]
}
